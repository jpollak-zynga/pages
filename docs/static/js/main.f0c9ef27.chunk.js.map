{"version":3,"sources":["tile.svg","isWord.tsx","TileDefinitions.tsx","TileSetComponent.tsx","AccordionCell.tsx","RulesComponent.tsx","App.tsx","Goals.ts","WordFinder.ts","serviceWorker.ts","index.tsx"],"names":["module","exports","__webpack_require__","p","TRIE","require","find","word","t","forEach","tile","letter","toLocaleLowerCase","TileDefinition","_class","props","Object","classCallCheck","this","initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","count","points","applyDecoratedDescriptor","prototype","observable","configurable","enumerable","writable","initializer","TileDefinitions","_class3","TileSet","name","tiles","_descriptor4","_descriptor5","map","e","TileDefinitionComponent","observer","_this$props","remaining","tileDefinition","react_default","a","createElement","className","concat","React","Component","TileSetComponent","_class2","_React$Component2","possibleConstructorReturn","getPrototypeOf","apply","arguments","inherits","createClass","key","value","_this","_this$props$tileSet","tileSet","Card_default","Header","Body","index","undefined","bag","filter","length","TileSetComponent_TileDefinitionComponent","AccordionCell","onClick","onSelect","eventKey","Accordion_default","Toggle","as","Card","style","cursor","title","Collapse","children","MoveTypes","SESSION_STORAGE_KEY","CURRENT_VERSION","RulesComponent","call","activeEventKey","setState","state","stateString","sessionStorage","getItem","JSON","parse","version","_unused","removeItem","setItem","stringify","options","changeOptions","resetOptions","defaultActiveKey","oneScoochPerTurn","Badge","variant","bonusForLongerWords","Badge_default","src_TileSetComponent","Form_default","Check","type","id","label","checked","onChange","originalOptions","objectSpread","Button_default","href","target","rel","Goal","board","letters","join","possibleWithBoard","move","checkWord","VerbGoal","_Goal","_getPrototypeOf2","_len","args","Array","_key","description","includes","endsWith","json","VerbPastGoal","_Goal2","_getPrototypeOf3","_this2","_len3","_key3","DoublesGoal","_Goal3","_this3","get","split","StartsWithGoal","_Goal4","_this4","startsWith","CheapskateGoal","some","LengthGoal","WordFinder","width","onWordFound","y","x","seed","search","pos","result","push","adjacent","info","prefix","next","getOwnPropertyNames","validIndex","indexOf","valid","splice","getPrefixInfo","adjacentFree","nextPos","nextTile","toLowerCase","toConsumableArray","MOVE_VARIANTS","play","nuke","pass","DEFAULT_OPTIONS","UID","classNames","classes","compact","playerScore","player","words","i","bonusPoints","reduce","b","getTileSet","tileSetName","TileSets","newGame","players","data","j","drop","loading","gameId","uuid","playerIndex","original","reordered","nukers","passers","over","goals","announcements","JSON_TO_URL_DATA","APP_ID","App","_React$Component","automation","loadGameId","forcePushGameData","batonTimeout","tickInterval","pollInterval","automateInterval","getToken","auth","password","deviceIdentifier","userId","authUserId","fetch","method","body","appId","headers","Content-Type","then","response","status","console","error","Error","statusText","token","log","issueToken","onAuthenticated","catch","registerDevice","localStorage","setInterval","poll","automate","pullGameData","lastSavedState","onExchange","aIndex","findIndex","bIndex","newIndex","scooched","change","canSelect","seedTile","indexRow","Math","floor","seedRow","abs","canScooch","keyA","keyB","getIndex","tick","myPlayer","_loop","_i","space","random","pendingDrops","clearDrops","pop","forceUpdate","availableLetters","sample","uniqBy","shift","onClickItem","onNuke","onPass","onPlay","_this$state","canNuke","automated","possibilities","findWords","sort","tilePoints","tileSelected","onSmear","toString","preserveIndex","tileToDeselect","smeared","onReset","playedWord","tileBonusPoints","unshift","drops","playMove","goal","check","announceGoal","without","query","queryString","window","location","Authorization","accessType","_response$meta","meta","boardState","baton","pullGameDataUpdating","gameState","parseGoals","ensureParticipant","fromJson","updateProhibited","gameStateLocked","newBaton","myUserId","timeout","Date","now","newState","warn","stateChangesWhileNotMyTurn","oldState","diff","update","setTimeout","clearTimeout","clearInterval","unassignedPlayer","Alert_default","Heading","selectableLetters","onDone","canPlay","playLabel","isWord","pendingMove","passWillResign","scoredPlayers","score","overHeader","_this$canNuke2","usedNuke","noMoreTiles","nukeTitle","stars","playedTile","starsString","Container_default","fluid","Row_default","Col_default","sm","Fragment","ButtonGroup_default","disabled","item","itIsMyTurn","currentPlayer","humanizeDuration","onAnimationEnd","message","SlideGrid","canExchange","tap","done","smear","exchange","backgroundImage","backgroundSize","backgroundRepeat","gameUrl","Figure_default","lib_default","Caption","Control","possible","md","pill","isCurrentPlayer","event","wordContent","url","stuff","Blob","URL","revokeObjectURL","createObjectURL","jsonToUrl","open","RulesComponent_RulesComponent","announce","distance","_this5","_this6","currentPlayerUserId","isMyTurn","zid","_this7","Boolean","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.f0c9ef27.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/tile.e1eb2eab.svg\";","export type TrieEntry = Trie | 1 | undefined;\nexport type Word = Array<{ letter: string }>;\n\ninterface Trie {\n  [key: string]: TrieEntry,\n}\n\nconst TRIE: Trie = require(\"./trie.json\");\n\nfunction find(word: Word) {\n  let t: TrieEntry = TRIE;\n  word.forEach((tile) => {\n    if (typeof t === \"object\") {\n      t = t[tile.letter.toLocaleLowerCase()];\n    }\n  });\n  return t;\n}\n\nexport default function isWord(word: Word) {\n  const t = find(word);\n  return typeof t === \"object\" && t[\"_\"] === 1;\n}\n\nexport function getPrefixInfo(prefix: Word) {\n  const t = find(prefix);\n  if (typeof t !== \"object\") {\n    return undefined;\n  }\n  const next = Object.getOwnPropertyNames(t);\n  const validIndex = next.indexOf(\"_\");\n  const valid = validIndex >= 0;\n  if (valid) {\n    next.splice(validIndex, 1);\n  }\n  if (next.length === 0) {\n    return true;\n  }\n  return { valid, next }\n}\n","import {observable} from \"mobx\";\n\nexport interface ITileDefinition {\n  letter: string;\n  count: number;\n  points: number;\n}\n\nexport class TileDefinition implements ITileDefinition {\n  @observable\n  public letter: string;\n\n  @observable\n  public count: number;\n\n  @observable\n  public points: number;\n\n  constructor(props: ITileDefinition) {\n    this.letter = props.letter;\n    this.count = props.count;\n    this.points = props.points;\n  }\n}\n\nexport interface ITileSet {\n  name: string;\n  tiles: ITileDefinition[];\n}\n\nexport class TileSet implements ITileSet {\n  @observable\n  public name: string;\n  \n  @observable\n  public tiles: ITileDefinition[];\n\n  constructor(name?: string, tiles?: ITileDefinition[]) {\n    this.name = name || \"Untitled\";\n    this.tiles = tiles || [];\n  }\n}\n\nconst DefaultTileDefinitions = [\n{\n    letter: \"A\",\n    count: 9,\n    points: 1,\n  },\n  {\n    letter: \"B\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"C\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"D\",\n    count: 5,\n    points: 2,\n  },\n  {\n    letter: \"E\",\n    count: 13,\n    points: 1,\n  },\n  {\n    letter: \"F\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"G\",\n    count: 3,\n    points: 3,\n  },\n  {\n    letter: \"H\",\n    count: 4,\n    points: 3,\n  },\n  {\n    letter: \"I\",\n    count: 6,\n    points: 1,\n  },\n  {\n    letter: \"J\",\n    count: 1,\n    points: 10,\n  },\n  {\n    letter: \"K\",\n    count: 1,\n    points: 5,\n  },\n  {\n    letter: \"L\",\n    count: 4,\n    points: 2,\n  },\n  {\n    letter: \"M\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"N\",\n    count: 5,\n    points: 2,\n  },\n  {\n    letter: \"O\",\n    count: 8,\n    points: 1,\n  },\n  {\n    letter: \"P\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"Q\",\n    count: 1,\n    points: 10,\n  },\n  {\n    letter: \"R\",\n    count: 6,\n    points: 1,\n  },\n  {\n    letter: \"S\",\n    count: 5,\n    points: 1,\n  },\n  {\n    letter: \"T\",\n    count: 7,\n    points: 1,\n  },\n  {\n    letter: \"U\",\n    count: 4,\n    points: 2,\n  },\n  {\n    letter: \"V\",\n    count: 2,\n    points: 5,\n  },\n  {\n    letter: \"W\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"X\",\n    count: 1,\n    points: 8,\n  },\n  {\n    letter: \"Y\",\n    count: 2,\n    points: 3,\n  },\n  {\n    letter: \"Z\",\n    count: 1,\n    points: 10,\n  },\n].map((e) => new TileDefinition(e));\n\nconst DefaultTileSet: ITileSet = new TileSet(\"Default\",  DefaultTileDefinitions)\n\nexport default [DefaultTileSet];\n","import React from \"react\";\nimport { observer } from \"mobx-react\";\nimport { ITileSet, ITileDefinition } from \"TileDefinitions\";\nimport Card from \"react-bootstrap/Card\";\nimport { ITile } from \"App\";\n\ninterface ITileSetComponentProps {\n    tileSet: ITileSet;\n    bag?: ITile[];\n}\n\ninterface ITileSetComponentState {\n\n}\n\n@observer\nclass TileDefinitionComponent extends React.Component<{ tileDefinition: ITileDefinition, remaining?: number }> {\n    public render() {\n        const { remaining, tileDefinition } = this.props;\n        const { letter, points, count } = tileDefinition;\n        return <div className=\"tile-definition\">\n            <div className=\"tile\">\n                <div className=\"field\">\n                    <div className=\"letter\">{letter}</div>\n                    <div className=\"points\">{points}</div>\n                </div>\n            </div>\n            &nbsp;x&nbsp;{remaining ? `${remaining}/` : \"\"}{count}\n        </div>\n    }\n}\n\n@observer\nexport class TileSetComponent extends React.Component<ITileSetComponentProps, ITileSetComponentState> {\n    public render() {\n        const { name, tiles } = this.props.tileSet;\n        return <Card className=\"moves\">\n            <Card.Header>{name}</Card.Header>\n            <Card.Body>\n                {tiles.map((tileDefinition, index) => {\n                    let remaining: number | undefined = undefined;\n                    if (this.props.bag) {\n                        remaining = this.props.bag.filter((tile) => tile.letter === tileDefinition.letter).length;\n                    }\n                    return <TileDefinitionComponent\n                        key={index}\n                        tileDefinition={tileDefinition}\n                        remaining={remaining} />;\n                })}\n            </Card.Body>\n        </Card>\n    }\n}\n\nexport default TileSetComponent;\n","import React from 'react';\nimport Accordion from 'react-bootstrap/Accordion';\nimport Card from 'react-bootstrap/Card';\n\nexport default function AccordionCell(props: {\n  eventKey: string;\n  title: React.ReactNode;\n  children?: React.ReactNode;\n  onSelect(eventKey: string): void;\n}) {\n    const onClick = props.onSelect ? () => props.onSelect(props.eventKey) : undefined;\n  return <Card>\n    <Accordion.Toggle as={Card.Header} eventKey={props.eventKey} style={{ cursor: \"pointer\" }} onClick={onClick}>\n      {props.title}\n    </Accordion.Toggle>\n    <Accordion.Collapse eventKey={props.eventKey}>\n      <Card.Body>\n        {props.children}\n      </Card.Body>\n    </Accordion.Collapse>\n  </Card>;\n}\n","import React from \"react\";\nimport Accordion from \"react-bootstrap/Accordion\";\nimport Form from 'react-bootstrap/Form';\nimport TileSetComponent from 'TileSetComponent';\nimport { IScoochOptions, ITile } from \"App\";\nimport Badge from \"react-bootstrap/Badge\";\nimport Button from \"react-bootstrap/Button\";\nimport AccordionCell from \"AccordionCell\";\nimport { TileSet } from \"TileDefinitions\";\n\ninterface IRulesProps {\n    options: IScoochOptions;\n    tileSet: TileSet;\n    bag: ITile[];\n\n    changeOptions(change: (options: IScoochOptions) => IScoochOptions): void;\n    resetOptions(): void;\n}\n\ninterface IRulesState {\n  version: string;\n  activeEventKey: string | undefined;\n}\n\nconst SESSION_STORAGE_KEY = \"rulesState\";\n\nconst CURRENT_VERSION = \"0.4.2\";\n\nexport default class RulesComponent extends React.Component<IRulesProps, IRulesState> {    \n    constructor(props: IRulesProps) {\n        super(props);\n        const stateString = sessionStorage.getItem(SESSION_STORAGE_KEY);\n        if (stateString) {\n            try {\n                const state = JSON.parse(stateString) as IRulesState;\n                if (state.version !== CURRENT_VERSION) {\n                  state.activeEventKey = \"help-new\";\n                  state.version = CURRENT_VERSION;\n                }\n                this.state = state;\n                return;\n            } catch {\n                sessionStorage.removeItem(SESSION_STORAGE_KEY);\n            }\n        }\n        this.state = { activeEventKey: \"help-new\", version: CURRENT_VERSION };\n    }\n\n    public componentDidUpdate() {\n        sessionStorage.setItem(SESSION_STORAGE_KEY, JSON.stringify(this.state));\n    }\n\n    public render() {\n        const {options, tileSet, bag, changeOptions, resetOptions} = this.props;\n        return <Accordion className=\"mt-5\" defaultActiveKey={this.state.activeEventKey}>\n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-new\" title={`Whats New (v${CURRENT_VERSION})`}>\n          <dl>\n            <dt>Goals</dt>\n            <dd>There are now randomly-selected bonus goals shown below the play area. Complete them to earn bonus points!</dd>\n\n            <dt>Automation</dt>\n            <dd>Play against the computer, or have it take over for someone! Select the \"Automated\" option under a players name.</dd>\n          </dl>\n        </AccordionCell>\n\n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-words\" title=\"Making Words\">\n          <ul>\n            <li>Click <span className=\"field\">tiles</span> to add them to your word.</li>\n            <li>Click a <span className=\"field selected\">selected</span> tile to remove it from your word.</li>\n            <li>You may only add tiles <span className=\"field\">close</span> to the last letter of your word  other tiles are <span className=\"field unselectable\">too far</span>.</li>\n            <li>Never fear! You may scooch tiles around to make the word you want! Whether <span className=\"field\">near</span> or <span className=\"field unselectable\">far</span>, just drag tiles to where you need them.</li>\n            <li>When you scooch a tile, it switches places with its neighbor, and both tiles lose their point values.</li>\n            {options.oneScoochPerTurn && <li><Accordion.Toggle as={Badge} eventKey=\"options\" variant=\"secondary\">Option</Accordion.Toggle> You may only scooch one tile per turn, though you can move it as far as you want, and don't have to do it all at once.</li>}\n            {options.bonusForLongerWords && <li><Accordion.Toggle as={Badge} eventKey=\"options\" variant=\"secondary\">Option</Accordion.Toggle> Play longer words to get bonus points!</li>}\n          </ul>\n        </AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-end-turn\" title=\"Ending Your Turn\"><p>\n          Once youre happy with your word, click the <Badge variant=\"primary\">Play Word</Badge> button.\n          e tiles that make up your word go onto the scoreboard,\n            tiles left on the board drop down into their places,\n              w tiles slide in from the top to fill up the board.\n                s you scooched but didnt use get their points back,\n          and its the next players turn!\n        </p></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-nuke\" title=\"The Nuclear Option\"><p>\n          Also known as flipping the table, once per game each player may use the <Badge variant=\"warning\">Nuke</Badge> button to throw all the tiles on the board back into the bag and draw new ones.\n          There is no penalty  you wont lose your turn or any points  but you may only use the nuclear option once!\n        </p></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-end\" title=\"End of the Game\"><p>\n          When the tile bag is empty, youll notice empty spaces left on the board after tiles drop down.\n          (You can't scooch with those empty spaces.)\n          Eventually, there wont be more words to make, and youll have to <Badge variant=\"secondary\">Pass</Badge>.\n          After all players pass in a row, the game ends, and the player with the most points wins!\n        </p></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-tiles\" title=\"Tile Distribution\">\n          <TileSetComponent tileSet={tileSet} bag={bag} />\n        </AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-proto\" title=\"Prototype Notes\"><dl>\n          <dt>Scooch Limit</dt>\n          <dd>\n            When playing with the physical prototype, we generally made the rule that you could only scooch one tile\n            per turn, though you could move it as far as you wanted.Right now this version does <i>not</i> limit you\n            to a single scooch per turn, but that may change.\n          </dd>\n          <dt>Point Values</dt>\n          <dd>\n            The big tiles (\n            <span className=\"field\">J</span>\n            <span className=\"field\">Q</span>\n            <span className=\"field\">X</span>\n            <span className=\"field\">Z</span>) are way too valuable without the riposte available in games like\n            rabble and Words With Friends theyre completely dominant in final scoring.I did run a test\n                 physical prototype where scores were compressed, with the highest score being five, and the\n                  re far more balanced (and felt fair) but were also boring.I need to find a blance  perhaps\n            with the big tiles scoring seven points to restore the excitement and variability.\n          </dd>\n        </dl></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"options\" title=\"Options\">\n          <Form.Check type=\"checkbox\" id=\"on-scooch\" label=\"One scooch per turn\" checked={!!options.oneScoochPerTurn} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.oneScoochPerTurn = !options.oneScoochPerTurn;\n            return options;\n          })} />\n          <Form.Check type=\"radio\" id=\"on-length-none\" label=\"No bonus points for longer words\" checked={!!options.bonusForLongerWords === false} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.bonusForLongerWords = false;\n            return options;\n          })} />\n          <Form.Check type=\"radio\" id=\"on-length\" label=\"One bonus point for each letter over four tiles\" checked={options.bonusForLongerWords === \"constant\"} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.bonusForLongerWords = \"constant\";\n            return options;\n          })} />\n          <Form.Check type=\"radio\" id=\"on-length-linear\" label=\"Increasing bonus points for words over three tiles\" checked={options.bonusForLongerWords === \"linear\"} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.bonusForLongerWords = \"linear\";\n            return options;\n          })} />\n          <Button onClick={() => resetOptions()}>Reset</Button>\n        </AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"dictionary\" title=\"Acceptable Words\">\n          <p>\n            Words need to be at least three letters long and are checked against the <a href=\"https://diginoodles.com/The_English_Open_Word_List_%28EOWL%29\" target=\"_blank\" rel=\"noopener noreferrer\">English Open Word List</a> (EOWL).\n          </p>\n          <dl>\n            <dt>\n              UK Advanced Cryptics Dictionary Licensing Information\n            </dt>\n            <dd>\n              Copyright  J Ross Beresford 1993-1999. All Rights Reserved.The following restriction is placed on the use of this publication: if the UK Advanced Cryptics Dictionary is used in a software package or redistributed in any form, the copyright notice must be prominently displayed and the text of this document must be included verbatim.\n            </dd>\n            <dt>\n              <a href=\"https://diginoodles.com/The_English_Open_Word_List_%28EOWL%29\" target=\"_blank\" rel=\"noopener noreferrer\">The English Open Word List</a>\n            </dt>\n            <dd>\n              The EOWL was developed by Ken Loge, and based on the above UKACD, but he explicitly placed no additional rescrtictions on its use.\n            </dd>\n          </dl>\n    \n        </AccordionCell>\n      </Accordion>;\n    }\n\n    private onSelect = (activeEventKey: string) => this.setState((state) => {\n        if (state.activeEventKey === activeEventKey) {\n            return {activeEventKey: undefined};\n        } else {\n            return {activeEventKey};\n        }\n    });\n}\n","import React from 'react';\nimport Alert from 'react-bootstrap/Alert';\nimport Badge from 'react-bootstrap/Badge';\nimport Button from 'react-bootstrap/Button';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport Col from 'react-bootstrap/Col';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport SlideGrid from '@pyrogenic/slide-grid/lib/SlideGrid';\nimport without from 'lodash/without';\nimport compact from 'lodash/compact';\nimport uniqBy from 'lodash/uniqBy';\nimport sample from 'lodash/sample';\nimport isWord from './isWord';\nimport TileSets from './TileDefinitions';\nimport './App.css';\nimport RulesComponent from 'RulesComponent';\nimport {IPlay, IPlayedTile, Move} from './Move';\nimport {CheapskateGoal, DoublesGoal, IGoal, LengthGoal, StartsWithGoal, VerbGoal, VerbPastGoal} from 'Goals';\nimport Card from 'react-bootstrap/Card';\nimport WordFinder from './WordFinder';\nimport Form from 'react-bootstrap/Form';\nimport uuid from 'uuid/v4';\nimport * as queryString from \"querystring\";\nimport Figure from \"react-bootstrap/Figure\";\nimport QRCode from \"qrcode.react\";\nimport tile from \"./tile.svg\"\nimport humanizeDuration from \"humanize-duration\";\nimport * as diff from \"diff\";\n\nexport interface ITile {\n  type: \"letter\" | \"space\" | \"drop\";\n  id: string;\n  letter: string;\n  points: number;\n  renderIndex?: number;\n  drop: number;\n}\n\nenum MoveTypes {\n  pass = \"pass\",\n  nuke = \"nuke\",\n  play = \"play\",\n}\n\ntype Variant = undefined\n  | 'primary'\n  | 'secondary'\n  | 'success'\n  | 'danger'\n  | 'warning'\n  | 'info'\n  | 'dark'\n  | 'light'\n  | 'link'\n  | 'outline-primary'\n  | 'outline-secondary'\n  | 'outline-success'\n  | 'outline-danger'\n  | 'outline-warning'\n  | 'outline-info'\n  | 'outline-dark'\n  | 'outline-light';\n\ntype BadgeVariant = Exclude<Variant, \"link\"\n  | \"outline-primary\"\n  | 'outline-secondary'\n  | 'outline-success'\n  | 'outline-danger'\n  | 'outline-warning'\n  | 'outline-info'\n  | 'outline-dark'\n  | 'outline-light'>;\n\nconst MOVE_VARIANTS: { [P in MoveTypes]: BadgeVariant } = {\n  play: \"primary\",\n  nuke: \"warning\",\n  pass: \"secondary\",\n};\n\ninterface IPlayer {\n  name: string;\n  userId?: string;\n  words: Move[];\n  automated?: boolean;\n}\n\nexport interface IScoochOptions {\n  oneScoochPerTurn?: boolean;\n  tileSetName?: string;\n  bonusForLongerWords?: false | \"constant\" | \"linear\";\n}\n\nconst DEFAULT_OPTIONS: IScoochOptions = {\n  oneScoochPerTurn: true,\n  bonusForLongerWords: \"linear\",\n}\n\ntype IAutomationAction = {\n  type: \"tap\", a: string,\n} | {\n  type: \"scooch\",\n  a: string,\n  b: string,\n} | {\ntype: \"submit\" | \"wait\" | \"nuke\" | \"pass\",\n}\n\nlet UID = 1;\n\ninterface IAnnouncement {\n  key: number,\n  title: string,\n  message: string,\n}\n\ninterface IAppState {\n  loading: string;\n  gameId: string;\n  gameVersion?: number;\n  baton?: {\n    userId: string,\n    timeout: number,\n  },\n  options: IScoochOptions;\n  players: IPlayer[];\n  playerIndex: number;\n  nukers: number[];\n  passers: number[];\n  over: boolean;\n  announcements: IAnnouncement[];\n  bag: ITile[];\n  board: ITile[];\n  original: ITile[];\n  word: ITile[];\n  reordered: ITile[];\n  scooched?: string;\n  smeared?: boolean;\n  goals: IGoal[];\n}\n\nfunction classNames(...classes: Array<string | false | undefined>) {\n  classes = compact(classes);\n  if (classes.length === 0) {\n    return undefined;\n  }\n  return classes.join(\" \");\n}\n\nfunction playerScore(player: IPlayer) {\n  return player.words.map((i) => i.type === \"play\" ? i.points + i.bonusPoints : 0).reduce((a, b) => (a + b), 0);\n}\n\nfunction getTileSet(tileSetName?: string) {\n  return TileSets.find((e) => e.name === tileSetName) || TileSets[0]!\n}\n\nfunction newGame(players?: IPlayer[], tileSetName?: string): IAppState {\n  const board: ITile[] = [];\n  const bag: ITile[] = [];\n  let id = 0;\n  const tileSet = getTileSet(tileSetName);\n  tileSet.tiles.forEach((data) => {\n    for (let j = 0; j < data.count; j++) {\n      bag.push({\n        type: \"letter\",\n        id: `tile-${id++}`,\n        letter: data.letter,\n        points: data.points,\n        drop: 0,\n      })\n    }\n  });\n  for (let j = 0; j < 16; j++) {\n    board.push({\n      type: \"drop\",\n      id: `blank-${j}`,\n    } as ITile)\n  }\n  players = players || [];\n  players.forEach((player) => player.words = []);\n  const options = { ...DEFAULT_OPTIONS, tileSetName: tileSet.name };\n  const gameId = uuid();\n  return { loading: \"bootstrap\", gameId, players, playerIndex: 0, bag, board, original: Array(...board), word: [], reordered: [], nukers: [], passers: [], over: false, options, goals: [], announcements: [] };\n}\n\n// Cache of generated json data URLs\nconst JSON_TO_URL_DATA: { [key: string]: string } = {};\n\nfunction jsonToUrl(key: string, stuff: any) {\n  const data = new Blob([JSON.stringify(stuff)], { type: \"application/json\" });\n\n  // If we are replacing a previously generated file we need to\n  // manually revoke the object URL to avoid memory leaks.\n  if (JSON_TO_URL_DATA[key]) {\n    window.URL.revokeObjectURL(JSON_TO_URL_DATA[key]);\n  }\n\n  JSON_TO_URL_DATA[key] = window.URL.createObjectURL(data);\n\n  // returns a URL you can use as a href\n  return JSON_TO_URL_DATA[key];\n}\n\ninterface IAuth {\n  userId: string;\n  zid: string;\n  password: string;\n  token: string;\n}\n\nconst APP_ID =  5005139;\n\ninterface IQuery {\n  gameId?: string;\n}\n\nexport class App extends React.Component<{}, IAppState> {\n  private automation: IAutomationAction[] = [];\n  private loadGameId?: string;\n  private forcePushGameData?: boolean;\n\n  private batonTimeout?: any;\n  private tickInterval?: any;\n  private pollInterval?: any;\n  private automateInterval?: any;\n\n  constructor(props: any) {\n    super(props);\n    this.tickInterval = setInterval(this.tick, 100);\n    // const stateString = sessionStorage.getItem(\"boardState\");\n    // if (stateString) {\n    //   try {\n    //     const state = JSON.parse(stateString) as IAppState;\n    //     for (let i = 0; i < state.word.length; i++) {\n    //       state.word[i] = state.board.find((tile) => tile.id === state.word[i].id)!;\n    //     }\n    //     for (let i = 0; i < state.reordered.length; i++) {\n    //       state.reordered[i] = state.board.find((tile) => tile.id === state.reordered[i].id)!;\n    //     }\n    //     if (state.nukers === undefined) {\n    //       state.nukers = [];\n    //     }\n    //     if (state.passers === undefined) {\n    //       state.passers = [];\n    //     }\n    //     if (state.options === undefined) {\n    //       state.options = {};\n    //     }\n    //     if (state.announcements === undefined) {\n    //       state.announcements = [];\n    //     }\n    //     if (state.gameId === undefined) {\n    //       state.gameId = uuid();\n    //     }\n    //     state.goals = [];\n    //     this.state = state;\n    //     return;\n    //   } catch {\n    //     sessionStorage.clear();\n    //   }\n    // }\n    this.loadGameId = sessionStorage.getItem(\"gameId\") || undefined;\n    this.state = newGame();\n  }\n\n  public componentDidMount(): void {\n    const query = queryString.parse(window.location.search.split(\"?\").pop() || \"\") as IQuery;\n    this.loadGameId = query.gameId;\n    this.getToken();\n  }\n\n  private getToken = () => {\n    if (this.auth) {\n      return;\n    }\n    let password = this.deviceIdentifier;\n    let userId = this.authUserId;\n    if (userId === undefined) {\n      this.setState({loading: \"register-device\"}, () =>\n      fetch(\"https://api.zynga.com/auth/registerDevice\",\n          {method: \"POST\", body: JSON.stringify({password, appId: APP_ID}), headers: {\"Content-Type\": \"application/json\"}})\n          .then((response) => response.json())\n          .then((auth: IAuth) => {\n            console.log({registerDevice: auth});\n            localStorage.setItem(\"DeviceIdentifier\", password);\n            localStorage.setItem(\"AuthUserId\", auth.userId);\n            this.getToken();\n          })\n          .catch(console.error));\n      return;\n     }\n    this.setState({loading: \"authenticating\"}, () =>\n   fetch(\"https://api.zynga.com/auth/issueToken\",\n        {\n          method: \"POST\",\n          body: JSON.stringify({password, userId, appId: APP_ID}),\n          headers: {\"Content-Type\": \"application/json\"}\n        })\n        .then((response) => {\n          if (response.status < 400) {\n            return response.json();\n          } else {\n            console.error(response);\n            throw new Error(response.statusText);\n          }\n        })\n        .then((token) => {\n          if (token) {\n            console.log({issueToken: token});\n            this.auth = {\n              password, userId, ...token,\n            };\n            this.onAuthenticated();\n          } else {\n            throw new Error(\"no json body\");\n          }\n        })\n        .catch(console.error));\n  }\n\n  private auth?: IAuth;\n\n  private get deviceIdentifier() {\n    return localStorage.getItem(\"DeviceIdentifier\") || uuid();\n  }\n\n  private get authUserId() {\n    return localStorage.getItem(\"AuthUserId\") || undefined;\n  }\n\n  private onAuthenticated = () => {\n    this.pollInterval = setInterval(this.poll, 5000);\n    this.automateInterval = setInterval(this.automate, 1000);\n    const gameId = this.loadGameId;\n    if (gameId) {\n      this.setState({loading: \"joining-game\"}, () =>\n          this.pullGameData(gameId));\n    }\n  };\n\n  private poll = () => {\n    if (!this.auth) {\n      return;\n    }\n    const gameId = this.loadGameId || this.state.gameId;\n    if (gameId) {\n      this.setState({loading: \"loading-game\"}, () =>\n        this.pullGameData(gameId));\n    }\n  }\n\n  private pullGameData(gameId: string) {\n    if (!this.auth) {\n      return;\n    }\n    fetch(\"https://api.zynga.com/conversation/join\",\n        {\n          method: \"POST\",\n          headers: {\"Content-Type\": \"application/json\", \"Authorization\": \"token \" + this.auth.token},\n          body: JSON.stringify({\n            accessType: \"public\",\n            id: gameId,\n          })\n        })\n        .then((response) => response.json())\n        .then((response) => {\n          const {boardState, baton} = response.meta;\n          if (typeof boardState === \"string\" && this.lastSavedState !== boardState) {\n            console.log({pullGameDataUpdating: response});\n            this.lastSavedState = boardState;\n            this.batonTimeout = undefined;\n            const gameState : IAppState = JSON.parse(boardState);\n            gameState.goals = this.parseGoals(gameState.goals);\n            this.setState({...this.state, ...gameState, baton, loading: \"ready\"} as any);\n          } else {\n            this.setState({loading: \"ready\"}, this.ensureParticipant);\n          }\n        })\n        .catch(console.error);\n  }\n\n  private parseGoals(goals: IGoal[]): IGoal[] {\n    return goals.map( (goal) => {\n        switch (goal.type) {\n          case \"Double Up\":\n            return DoublesGoal.fromJson(goal);\n          case \"Cheapskate\":\n            return CheapskateGoal.fromJson(goal);\n          case \"Get Moving\":\n            return VerbGoal.fromJson(goal);\n          case \"Over It\":\n            return VerbPastGoal.fromJson(goal);\n          case \"Shortie\":\n            return LengthGoal.fromJson(goal);\n          case \"Up Front\":\n            return StartsWithGoal.fromJson(goal);\n          default:\n            throw new Error(`Unknown goal type: ${goal.type}`);\n        }\n      });\n  }\n\n  private get myPlayer() {\n    if (!this.state.players) {\n      return undefined;\n    }\n    return this.state.players.find((p) => p.userId === this.myUserId);\n  }\n\n// private static finderUrl(gameId: string, version: number) {\n  // `  return `https://api.zynga.com/finder/app/${APP_ID}/index/${GAME_INDEX}/id/${gameId}?version=${version}`;\n  // }\n\n  private lastSavedState?: string;\n\n  private get itIsMyTurn() {\n    const myUserId = this.myUserId;\n    if (!myUserId) {\n      return false;\n    }\n    const currentPlayerUserId = this.currentPlayer.userId;\n    const isMyTurn = currentPlayerUserId === myUserId;\n    console.log({myUserId, currentPlayerUserId, isMyTurn});\n    return isMyTurn;\n  }\n\n  private get currentPlayer() {\n    return this.state.players[this.state.playerIndex];\n  }\n\n  private get myUserId() {\n    if (!this.auth) {\n      return undefined;\n    }\n    return this.auth.zid;\n  }\n\n  public componentDidUpdate() {\n    if (this.myPlayer && localStorage.getItem(\"Name\") !== this.myPlayer.name) {\n      localStorage.setItem(\"Name\", this.myPlayer.name);\n    }\n    if (!this.auth) {\n      return;\n    }\n    this.ensureParticipant();\n    const token = this.auth.token;\n    if (this.state.reordered.length > 0 && (this.state.board.find((e, i) => this.state.original[i] !== e) === undefined)) {\n      this.setState({ reordered: [], scooched: undefined });\n    } else {\n      const updateProhibited = this.gameStateLocked;\n      const newBaton = {\n        userId: this.myUserId!,\n        timeout: Date.now() + 1000,\n      };\n      const newState = {...this.state,\n        loading: \"saved\", baton: undefined,\n        auth: undefined, version: undefined};\n      const boardState = JSON.stringify(newState);\n      if (boardState !== this.lastSavedState) {\n        if (!updateProhibited) {\n          this.forcePushGameData = false;\n\n          const oldState = JSON.parse(this.lastSavedState || \"{}\");\n          console.log(diff.diffJson(oldState, newState));\n\n          this.lastSavedState = boardState;\n          const {gameId} = this.state;\n          fetch(\"https://api.zynga.com/conversation/join\",\n              {\n                method: \"POST\",\n                headers: {\"Content-Type\": \"application/json\", \"Authorization\": \"token \" + token},\n                body: JSON.stringify({\n                  accessType: \"public\",\n                  id: gameId,\n                  meta: boardState,\n                })\n              })\n              .then((response) => response.json())\n              .then((response) => {\n                console.log({join: response});\n                sessionStorage.setItem(\"gameId\", response.id);\n                return fetch(\"https://api.zynga.com/conversation/editConversationMeta\",\n                    {\n                      method: \"POST\",\n                      headers: {\"Content-Type\": \"application/json\", \"Authorization\": \"token \" + token},\n                      body: JSON.stringify({\n                        accessType: \"public\",\n                        id: gameId,\n                        meta: {baton: newBaton, boardState},\n                      })\n                    });\n              })\n              .then((response) => response.json())\n              .then((response) => {\n                console.log({update: response});\n                this.batonTimeout = undefined;\n                this.setState({baton: newBaton});\n              })\n              .catch(console.error);\n        } else {\n          console.warn({stateChangesWhileNotMyTurn: newState, lastSavedState: this.lastSavedState && JSON.parse(this.lastSavedState)});\n        }\n      }\n    }\n    if (this.state.baton) {\n      if (!this.batonTimeout) {\n        this.batonTimeout = setTimeout(() => this.setState((state) => {\n          this.batonTimeout = undefined;\n          if (state.baton && state.baton.timeout < Date.now()) {\n            return {baton: undefined};\n          }\n          return {};\n        }), this.state.baton.timeout - Date.now());\n      }\n    }\n  }\n\n  componentWillUnmount(): void {\n    if (this.batonTimeout) {\n      clearTimeout(this.batonTimeout)\n    }\n    if (this.tickInterval) {\n      clearInterval(this.tickInterval)\n    }\n    if (this.pollInterval) {\n      clearInterval(this.pollInterval)\n    }\n    if (this.automateInterval) {\n      clearInterval(this.automateInterval)\n    }\n  }\n\n  private get gameStateLocked() {\n    return this.state.baton && this.state.baton.userId !== this.myUserId && this.state.baton.timeout > Date.now();\n  }\n\n  private ensureParticipant() {\n    const myPlayer = this.myPlayer;\n    if (myPlayer === undefined) {\n      let players = this.state.players;\n      const unassignedPlayer = players.find((e) => e.userId === undefined);\n      if (unassignedPlayer) {\n        unassignedPlayer.userId = this.myUserId;\n      } else {\n        players.push({name: localStorage.getItem(\"Name\") || \"Anonymous\", words: []});\n        this.forcePushGameData = true;\n      }\n      this.setState({players});\n    }\n  }\n\n  public render() {\n    if (this.myPlayer === undefined) {\n      return <Alert><Alert.Heading>Loading</Alert.Heading><p>{this.state.loading}</p></Alert>;\n    }\n    const tileSet = getTileSet(this.state.options.tileSetName);\n    // const totalTiles = tileSet.tiles.map((tile) => tile.count).reduce((a, b) => a + b);\n    // const totalPoints = tileSet.tiles.map((tile) => tile.count * tile.points).reduce((a, b) => a + b);\n    let selectableLetters = Array(...this.state.board);\n    if (this.state.word.length > 0) {\n      selectableLetters = selectableLetters.filter((tile, index) => this.canSelect(index));\n    }\n    let canPlay = false;\n    let playLabel = \"Too Short\";\n    if (this.state.word.length > 2) {\n      canPlay = isWord(this.state.word);\n      const word = this.state.word.map((tile) => tile.letter).join(\"\");\n      let points = this.state.word.map(this.tilePoints).reduce((a, b) => (a || 0) + (b || 0));\n      let bonusPoints = this.state.word.map(this.bonusPoints).reduce((a, b) => (a || 0) + (b || 0)) || 0;\n      bonusPoints = bonusPoints + this.state.goals.map((goal) => goal.check(this.pendingMove) ? goal.points : 0).reduce((a, b) => a + b, 0);\n      points = (points || 0) + bonusPoints;\n      if (canPlay) {\n        if (this.state.smeared) {\n          playLabel = `Release to play '${word}' for ${points || \"no\"} points`;\n        } else {\n          playLabel = `Play '${word}' for ${points || \"no\"} points`;\n        }\n      } else {\n        playLabel = `'${word}' is not a word`;\n      }\n    }\n \n    // If the player was smearing, auto-play if possible. \n    // If the player was tapping letters or scooching, though, don't do anything.\n    let onDone: ((key: string) => void) | undefined;\n    if (this.state.smeared) {\n      if (canPlay) {\n        onDone = this.onPlay;\n      } else {\n        onDone = (id) => {\n          // TODO: this should probably be an option\n          // deselect everything if the smear ends on a selected tile and the word's invalid,\n          // otherwise leave state unchanged (as in the end of a scooch)\n          const i = this.state.word.findIndex((tile) => tile.id === id);\n          console.log({ id, word: this.state.word, i });\n          if (i >= 0) {\n            this.setState({ word: [] });\n          }\n        };\n      }\n    } else {\n      onDone = undefined;\n    }\n\n    const passWillResign = this.state.passers.includes(this.state.playerIndex);\n    const scoredPlayers = this.state.players.map((player) => {\n      const score = playerScore(player);\n      return { score, ...player };\n    }).sort((a, b) => b.score - a.score);\n    let overHeader = <Alert.Heading>{scoredPlayers[0].name} Wins!</Alert.Heading>;\n    if (scoredPlayers.find((e) => e.score !== scoredPlayers[0].score) === undefined) {\n      overHeader = <Alert.Heading>Its a tie!</Alert.Heading>;\n    }\n    const { usedNuke, noMoreTiles, canNuke } = this.canNuke();\n    let nukeTitle = \"Nuclear Option: discard all tiles and draw new ones. You may only do this once per game.\";\n    if (usedNuke) {\n      nukeTitle = \"You may only use the nuclear option once per game.\";\n    } else if (noMoreTiles) {\n      nukeTitle = \"Its too late to use the nuclear option.\";\n    }\n\n    const yourPoints = this.state.players[0].words.map((play) => play.type === \"play\" ? play.points + play.bonusPoints : 0).reduce((a, b) => a + b, 0);\n    //const yourTiles = this.state.players[0].words.map((play) => play.type === \"play\" ? play.word.length : 0).reduce((a, b) => a + b, 0);\n    //const targetPoints = (yourTiles / totalTiles) * totalPoints;\n    const yourTargetPoints = this.state.players[0].words\n      .map((play) => play.type === \"play\" ? play.word : [])\n      .reduce((a, b) => a.concat(b), [])\n      .map((playedTile) => playedTile.letter)\n      .map((letter) => tileSet.tiles.find((e) => e.letter === letter)!.points)\n      .reduce((a, b) => a + b, 0) + this.state.players[0].words.length;\n    const stars = yourPoints - yourTargetPoints;\n    let starsString = \"\";\n    for (let i = 0; i < Math.abs(stars); ++i) {\n      starsString += \"\";\n    }\n\n    return <Container fluid={true}>\n      <Row>\n        <Col className={compact([\"col-sm-12\", \"col-xl-6\", \"board-col\", this.state.over && \"over\"]).join(\" \")}>\n          <Row className=\"board-footer\">\n            <Col sm={4} className=\"sm-right\">\n              {this.state.players.length > 1\n                  ? <>\n                    {this.state.players[this.state.playerIndex].name}s Turn\n                  </>\n                  : <>\n                    {/* Solo Mode: {stars > 0 && \"+\"}{stars} */}\n                    <span className={`stars ${stars >= 0 ? \"positive\" : \"negative\"}`}>{starsString}</span>\n                    {/* Solo Mode: {yourPoints} / {yourTargetPoints} */}\n                  </>}\n            </Col>\n            <Col sm={4}>\n              <ButtonGroup>\n                <Button variant=\"secondary\" disabled={this.state.reordered.length === 0 && this.state.word.length === 0}\n                        title={\"Return all tiles to their original positions, restoring their point values.\"}\n                        onClick={this.onReset}>Reset</Button>\n                <Button variant={canNuke ? \"warning\" : \"secondary\"} disabled={!canNuke} title={nukeTitle}\n                        onClick={this.onNuke}>Nuke</Button>\n                <Button variant={passWillResign ? \"primary\" : \"secondary\"} disabled={this.state.over}\n                        onClick={this.onPass}>{passWillResign ? \"Finish\" : \"Pass\"}</Button>\n              </ButtonGroup>\n            </Col>\n            <Col sm={4} className=\"sm-left\">\n              {this.state.bag.length} tiles left\n              <Badge variant=\"secondary\">{this.state.loading}</Badge>\n            </Col>\n          </Row>\n          <Row>\n            <div className=\"play-area\">\n              <Row><Button\n                  className={classNames(\"play-button\", canPlay && \"can-play\")}\n                  variant={canPlay ? \"primary\" : \"outline-primary\"}\n                  disabled={!canPlay}\n                  onClick={this.onPlay}\n              >{playLabel}</Button>\n              </Row>\n              {this.state.word.map((item, index) => (\n                  <div key={index} className=\"tile\">\n                    <div className=\"field\">\n                      <div className=\"letter\">{item.letter}</div>\n                      <div className=\"points\">{this.tilePoints(item) || <>&nbsp;</>}</div>\n                      {this.bonusPoints(item) && <div className=\"bonus\">+{this.bonusPoints(item)}</div>}\n                    </div>\n                  </div>\n              ))}\n              {/* <div style={{marginTop: \"1rem\", textAlign: \"center\", border: \"1px solid black\"}}></div> */}\n              {this.state.word.length === 0 && <div className=\"tile space\"/>}\n              <div className=\"container\">\n                <div className=\"flex-grow\"/>\n              </div>\n            </div>\n          </Row>\n          <Row className=\"untouchable\">\n            {this.state.over &&\n            <div className=\"overlay\">\n              <Alert variant=\"success\" width=\"100%\">\n                {overHeader}\n                Final Score: {\n                scoredPlayers.map((player) => `${player.name}: ${player.score}`).join(\", \")\n              }\n              </Alert>\n            </div>}\n            {!this.itIsMyTurn &&\n            <div className=\"overlay\">\n              <Alert variant=\"info\" width=\"100%\">\n                <Alert.Heading>Its {this.currentPlayer.name}s Turn</Alert.Heading>\n                {this.gameStateLocked && <>Game state locked for {humanizeDuration(this.state.baton!.timeout - Date.now())}</>}\n              </Alert>\n            </div>}\n            {this.state.announcements &&\n            <div className=\"overlay\">\n              {this.state.announcements.map((a) =>\n                  <div key={a.key} className=\"announcement\"\n                       onAnimationEnd={() => this.setState((state) => ({announcements: without(state.announcements, a)}))}>\n                    <div className=\"title\">{a.title}</div>\n                    <div className=\"message\">{a.message}</div>\n                  </div>)}\n            </div>}\n            <SlideGrid\n                className=\"board\"\n                canExchange={this.canScooch}\n                tap={this.onClickItem}\n                done={onDone}\n                smear={this.onSmear}\n                exchange={this.onExchange}\n            >\n              {\n                this.state.board.map((item, index) => {\n                  const classes = [\"tile\"];\n                  if (this.state.word.includes(item)) {\n                    classes.push(\"selected\");\n                  }\n                  if (selectableLetters.indexOf(item) >= 0) {\n                    classes.push(\"selectable\");\n                  } else {\n                    classes.push(\"unselectable\");\n                  }\n                  if (this.canScooch(item.id)) {\n                    classes.push(\"swappable\");\n                  } else {\n                    classes.push(\"unswappable\");\n                  }\n                  if (item.type === \"space\") {\n                    classes.push(\"space\");\n                  }\n                  if (this.reordered(item)) {\n                    classes.push(\"reordered\");\n                  }\n                  if (this.state.options.oneScoochPerTurn && this.state.scooched === item.id) {\n                    classes.push(\"scooched\");\n                  }\n                  if ((index % 4) === 0) {\n                    classes.push(\"start-row\");\n                  }\n                  if (item.drop) {\n                    classes.push(`drop-${item.drop}`);\n                  }\n                  const id = item.id;\n                  return (\n                    <div className={classes.join(\" \")} key={id} id={id}>\n                      <div className=\"field\" style={{backgroundImage:`url(${tile})`, backgroundSize: 'contain', backgroundRepeat: 'no-repeat'}}>\n                        <div className=\"points\">{this.tilePoints(item) || <>&nbsp;</>}</div>\n                        <div className=\"letter\">{item.letter || <>&nbsp;</>}</div>\n                      </div>\n                    </div>\n                  );\n                })\n              }\n            </SlideGrid>\n          </Row>\n\n          <Row>\n            <Col>{this.gameUrl && <Figure>\n              <QRCode value={this.gameUrl}/>\n              <Figure.Caption>\n                <Form.Control type=\"text\" disabled={true} value={this.gameUrl} />\n              </Figure.Caption>\n            </Figure>}\n            </Col>\n          </Row>\n          <Row>\n            <Col>\n              <p>Baton: {JSON.stringify(this.state.baton)}</p>\n              {this.state.baton && <>Game state locked for {humanizeDuration(this.state.baton.timeout - Date.now())}</>}\n              {/*<p>{JSON.stringify(this.state.auth)}</p>*/}\n            {/*<Button onClick={() => {*/}\n            {/*  fetch(`https://api.zynga.com/storage/v1/app/${APP_ID}/blob/${this.state.gameId}/user/${this.state.auth!.zid}`,*/}\n            {/*      {method: \"GET\", body: JSON.stringify({payload: {value: \"JSON.stringify(this.state)\"}}),*/}\n            {/*        headers: {\"Content-Type\": \"application/json\", \"Authorization\": \"token \" + this.state.auth!.token}})*/}\n            {/*      .then((response) => response.json())*/}\n            {/*      .then(console.log)*/}\n            {/*      .catch(console.error);*/}\n\n            {/*}}>Load Game</Button>*/}\n            </Col>\n          </Row>\n\n          <Row>\n            <Card>\n              <Card.Header>\n                Goals\n              </Card.Header>\n              <Card.Body>\n                {this.state.goals.map((goal, index) => {\n                  const move = this.pendingMove;\n                  const possible = goal.possible(this.state.board);\n                  // TODO: doesn't take into account scooched tile's lost points?\n                  const thisMoveQualifies = canPlay && goal.check(move);\n                  const classNames = [\n                    \"goal\",\n                    thisMoveQualifies && \"qualifies\",\n                    possible && \"possible\",\n                  ];\n                  return <Row key={index} className={compact(classNames).join(\" \")}>\n                    <Col md={10}>\n                      <Badge variant=\"warning\">{goal.type}</Badge><br/>\n                      {goal.description}\n                    </Col>\n                    <Col md={2}>\n                      <Badge variant=\"success\" pill={true}>+{goal.points}</Badge>\n                    </Col>\n                  </Row>\n                })}\n              </Card.Body>\n            </Card>\n          </Row>\n        </Col>\n        <Col>\n          <Row className=\"players\">\n            {this.state.players.map((player, playerIndex) => {\n              const isCurrentPlayer = this.state.playerIndex === playerIndex;\n              return <Col key={`player-${playerIndex}`} md={6}\n                          className={compact([\"player\", isCurrentPlayer && \"current\"]).join(\" \")}>\n                <Row className=\"header\">\n                  <Col md={7} className=\"name\">\n                    <input type=\"text\" value={player.name} onChange={(event) => {\n                      player.name = event.target.value;\n                      this.setState((state) => {\n                        const players = Array(...state.players);\n                        return {players};\n                      });\n                    }}/>\n                  </Col>\n                  <Col md={2} className=\"score\">{playerScore(player)}</Col>\n                  <Col md={1}>{isCurrentPlayer && <div className=\"turn-indicator\"/>}</Col>\n                </Row>\n                <div>\n                  <Form.Check type=\"checkbox\" label=\"Automated\" checked={!!player.automated} onChange={(event: any) => {\n                    player.automated = event.target.checked;\n                    this.setState((state) => {\n                      const players = Array(...state.players);\n                      return {players};\n                    });\n                  }}/>\n                </div>\n                <div>\n                  {player.userId}\n                </div>\n                <div className=\"moves\">\n                  {player.words.map((play, index) => {\n                    let wordContent: any = <Badge pill={true} variant={MOVE_VARIANTS[play.type]}>{play.type}</Badge>;\n                    if (play.type === \"play\") {\n                      wordContent = <>{play.word.map((tile) => <div key={tile.id} className=\"tile\">\n                        <div className=\"field\">\n                          <div className=\"letter\">{tile.letter}</div>\n                          <div className=\"points\">{tile.points || <>&nbsp;</>}</div>\n                        </div>\n                      </div>)}\n                        {play.goals.map((goal) => <div className=\"bonus\">{goal.type}</div>)}\n                        {play.bonusPoints ? <div className=\"bonus\">+{play.bonusPoints}</div> : \"\"}\n                      </>;\n                    }\n                    return <Row key={index}><Col md={8}>{wordContent}</Col>\n                      <Col md={1}\n                           className=\"score\">{play.type === \"play\" && (play.points + play.bonusPoints)}</Col></Row>\n                  })}\n                </div>\n              </Col>\n            })}\n          </Row>\n\n          <Container className=\"mt-2\">\n            <ButtonGroup>\n              <Button variant=\"secondary\" onClick={() => this.setState((state) => {\n                const players = Array(...state.players);\n                players.pop();\n                return {players};\n              })}>-</Button>\n              <Button variant=\"outline-secondary\" disabled={true}>Players</Button>\n              <Button variant=\"secondary\" onClick={() => this.setState((state) => {\n                const players = Array(...state.players);\n                players.push({\n                  name: `Player ${players.length + 1}`,\n                  words: [],\n                });\n                return {players};\n              })}>+</Button>\n            </ButtonGroup>\n            <div className=\"flex-fill\"/>\n            <ButtonGroup>\n              <Button variant=\"outline-success\" onClick={() => {\n                const url = jsonToUrl(\"game.json\", this.state);\n                window.open(url, \"_blank\");\n              }}>Save Game</Button>\n              <Button variant=\"outline-danger\"\n                      onClick={() => this.setState(newGame(undefined, this.state.options.tileSetName))}>New\n                Game</Button>\n              <Button variant=\"outline-danger\"\n                      onClick={() => this.setState(newGame(this.state.players, this.state.options.tileSetName))}>with\n                Same Players</Button>\n            </ButtonGroup>\n          </Container>\n\n          <Row>\n            <Col>\n              <hr/>\n            </Col>\n          </Row>\n\n          <RulesComponent tileSet={this.tileSet} bag={this.state.bag} options={this.state.options}\n                          changeOptions={this.changeOptions} resetOptions={this.resetOptions}/>\n        </Col>\n      </Row>\n    </Container>;\n  }\n\n  private get gameUrl() {\n    if (this.state.gameId === undefined) {\n      return undefined;\n    }\n    return `${window.location.toString().split(\"?\").shift()}?gameId=${this.state.gameId}`;\n  }\n\n  private get pendingMove(): IPlay {\n    return {\n      type: \"play\",\n      word: this.state.word.map((tile) => ({...tile, points: this.state.reordered.includes(tile) ? 0 : tile.points})),\n      points: 0,\n      bonusPoints: 0,\n      goals: []\n    };\n  }\n\n  private onExchange = (a: string, b: string) => {\n    this.setState((state) => {\n      const aIndex = state.board.findIndex((e) => e.id === a);\n      const bIndex = state.board.findIndex((e) => e.id === b);\n      const board: ITile[] = [];\n      const reordered: ITile[] = Array(...state.reordered);\n      state.board.forEach((tile, index) => {\n        let newIndex = index;\n        if (index === aIndex) {\n          newIndex = bIndex;\n        }\n        else if (index === bIndex) {\n          newIndex = aIndex;\n        }\n        if (newIndex !== index && !reordered.includes(tile)) {\n          reordered.push(tile);\n        }\n        board[newIndex] = tile;\n      });\n      return { board, reordered, scooched: a };\n    });\n  }\n\n  private canNuke() {\n    const usedNuke = this.state.nukers.includes(this.state.playerIndex);\n    const noMoreTiles = this.state.bag.length === 0;\n    const canNuke = !usedNuke && !noMoreTiles;\n    return { usedNuke, noMoreTiles, canNuke };\n  }\n\n  private get tileSet() {\n    return getTileSet(this.state.options.tileSetName);\n  }\n\n  private changeOptions = (change: (options: IScoochOptions) => IScoochOptions) => {\n    this.setState((state) => ({options: change(state.options)}));\n  }\n\n  private resetOptions = () => {\n    this.setState({options: DEFAULT_OPTIONS});\n  }\n\n  private canSelect = (index: number) => {\n    if (this.state.word.length === 0) {\n      return true;\n    }\n    const seedTile = this.state.word[this.state.word.length - 1];\n    const seed = this.state.board.findIndex((tile) => tile === seedTile);\n    const indexRow = Math.floor(index / 4);\n    const seedRow = Math.floor(seed / 4);\n    if (indexRow === seedRow) {\n      return Math.abs(index - seed) === 1;\n    } else {\n      if (Math.abs(indexRow - seedRow) === 1) {\n        return Math.abs(index % 4 - seed % 4) <= 1;\n      }\n      return false;\n    }\n  }\n\n  private getTile(key: string) {\n    return this.state.board.find((e) => e.id === key);// || this.state.bag.find((e) => e.id === key);\n  }\n\n  private getIndex(key: string) {\n    return this.state.board.findIndex((e) => e.id === key);// || this.state.bag.find((e) => e.id === key);\n  }\n\n  private canScooch = (keyA: string, keyB?: string) => {\n    if (this.state.options.oneScoochPerTurn && this.state.scooched && ![keyA, keyB].includes(this.state.scooched)) {\n      return false;\n    }\n    const a = this.getIndex(keyA);\n    if (a < 0 || this.state.word.indexOf(this.state.board[a]) >= 0) {\n      return false;\n    }\n    if (this.state.board[a].type !== \"letter\") {\n      return false;\n    }\n    if (!keyB) {\n      return true;\n    }\n    const b = this.getIndex(keyB);\n    if (b < 0 || this.state.word.indexOf(this.state.board[b]) >= 0) {\n      return false;\n    }\n    if (this.state.board[b].type !== \"letter\") {\n      return false;\n    }\n    const indexRow = Math.floor(b / 4);\n    const seedRow = Math.floor(a / 4);\n    if (indexRow === seedRow) {\n      return Math.abs(b - a) === 1;\n    } else {\n      if (Math.abs(indexRow - seedRow) === 1) {\n        return b % 4 === a % 4;\n      }\n      return false;\n    }\n  }\n\n  private tick = () => {\n    if (this.myPlayer === undefined) { return; }\n    for (let i = this.state.board.length - 1; i >= 0; i--) {\n      const space = this.state.board[i];\n      if (space.type === \"drop\") {\n        this.setState((state) => {\n          const board = Array(...state.board);\n          const bag = Array(...state.bag);\n          i = board.indexOf(space);\n          if (i >= 0) {\n            if (state.bag.length > 0) {\n              const j = Math.floor(Math.random() * state.bag.length);\n              board[i] = bag.splice(j, 1)[0];\n              this.drop(board[i], space.drop);\n            } else {\n              board[i].type = \"space\";\n            }\n          }\n          return { bag, board, original: Array(...board) };\n        })\n        break;\n      }\n    }\n    if (this.pendingDrops.length === 0 && this.clearDrops.length > 0) {\n      while (this.clearDrops.length > 0) {\n        this.clearDrops.pop()!.drop = 0;\n      }\n      this.forceUpdate();\n      return;\n    }\n  }\n\n  private automate = () => {\n    if (this.myPlayer === undefined) { return; }\n    const { goals } = this.state;\n    if (goals.length < 3) {\n      const availableLetters = compact([...this.state.bag.map((e) => e.letter), ...this.state.board.map((e) => e.letter)]);\n      switch (Math.floor(Math.random() * 6)) {\n        case 0:\n          goals.push(new CheapskateGoal());\n          break;\n        case 1:\n          goals.push(new VerbGoal());\n          break;\n        case 2:\n          goals.push(new VerbPastGoal());\n          break;\n        case 3:\n          goals.push(new DoublesGoal(sample(\"RSTLNE\")!));\n          break;\n        case 4:\n          if (availableLetters.length > 0) {\n            goals.push(new StartsWithGoal(sample(availableLetters)!));\n          }\n          break;\n        case 5:\n          goals.push(new LengthGoal(sample([3, 4])!));\n          break;\n      }\n      this.setState({ goals: uniqBy(goals, JSON.stringify) });\n      return;\n    }\n\n    const automation = this.automation.shift();\n    if (automation) {\n      switch (automation.type) {\n        case \"tap\":\n          this.onClickItem(automation.a, false);\n          return;\n        case \"wait\":\n          return;\n        case \"nuke\":\n          this.onNuke();\n          return;\n        case \"pass\":\n          this.onPass();\n          return;\n        case \"submit\":\n          this.onPlay();\n          return;\n        default:\n          console.error({ automation });\n          return;\n      }\n    }\n\n    const {board, players, playerIndex} = this.state;\n    const { canNuke } = this.canNuke();\n    const currentPlayer = players[playerIndex];\n    if (currentPlayer.automated) {\n      if (!board.some((t)=>t.type === \"drop\")) {\n        const possibilities: Array<[number, ITile[]]> = [];\n        new WordFinder(board, 4, (word) => {\n          if (word.length >= 3) {\n            const points: number = word.map((e) => e.points).reduce((a, b) => a + b, 0);\n            possibilities.push([points, word]);\n          }\n        }).findWords();\n        possibilities.sort((a, b) => a[0] - b[0]);\n        const play = possibilities.pop();\n        console.log({possibilities});\n        if (play !== undefined) {\n          this.automation = play[1].map((e) => ({\n            type: \"tap\",\n            a: e.id,\n          }));\n          this.automation.push({type: \"wait\"});\n          this.automation.push({type: \"submit\"})\n        } else if (canNuke) {\n          this.automation.push({type: \"nuke\"});\n        } else {\n          this.automation.push({type: \"pass\"});\n        }\n      }\n    }\n  }\n\n  private reordered = (tile: ITile) => {\n    return this.state.reordered.includes(tile);\n  }\n\n  private tilePoints = (tile: ITile): number | undefined => {\n    if (this.reordered(tile)) {\n      return undefined;\n    }\n    return tile.points;\n  }\n\n  private bonusPoints = (tile: ITile): number | undefined => {\n    if (!this.state.options.bonusForLongerWords) {\n      return undefined;\n    }\n    const index = this.state.word.indexOf(tile);\n    if (this.state.options.bonusForLongerWords === \"constant\") {\n      if (index < 4) {\n        return undefined;\n      }\n      return 1;\n    }\n    if (index < 3) {\n      return undefined;\n    }\n    return index - 2;\n  }\n\n  private tileSelected = (tile: ITile, word?: ITile[]) => {\n    if (word === undefined) {\n      word = this.state.word;\n    }\n    return word.includes(tile);\n  }\n\n  private onSmear = (key: string) => {\n    const id = key;\n    const tile = this.state.board.find((tile) => tile.id.toString() === id);\n    if (tile) {\n      const index = this.state.board.indexOf(tile);\n      if (!this.tileSelected(tile)) {\n        if (this.canSelect(index)) {\n          this.onClickItem(key, true);\n        }\n      } else {\n        const preserveIndex = this.state.word.indexOf(tile);\n        const tileToDeselect = this.state.word[preserveIndex + 1];\n        if (tileToDeselect) {\n          this.onClickItem(tileToDeselect.id, true);\n        }\n      }\n    }\n  }\n  \n  private onClickItem = (key: string, smeared: boolean = false) => {\n    const id = key;\n    const tile = this.state.board.find((tile) => tile.id.toString() === id);\n    if (tile) {\n      const index = this.state.board.indexOf(tile);\n      if (this.tileSelected(tile) || this.canSelect(index)) {\n        this.setState((state) => {\n          const word = Array(...state.word);\n          if (this.tileSelected(tile, word)) {\n            while (this.tileSelected(tile, word)) {\n              word.pop();\n            }\n          } else {\n            word.push(tile);\n          }\n          return { word, smeared };\n        });\n      }\n    }\n  }\n\n  private onReset = () => {\n    this.setState((state) => {\n      return { word: [], board: state.original, reordered: [], scooched: undefined };\n    });\n  }\n\n  private onNuke = () => {\n    this.setState((state) => {\n      const board: ITile[] = [];\n      for (let j = 0; j < 16; j++) {\n        board.push({\n          type: \"drop\",\n          id: `blank-${j}`,\n        } as ITile)\n      }\n      const bag: ITile[] = Array(...state.bag);\n      state.board.forEach((tile) => {\n        if (tile.type === \"letter\") {\n          bag.push(tile);\n        }\n      });\n      const playerIndex = state.playerIndex;\n      const nukers = Array(...state.nukers);\n      nukers.push(playerIndex);\n      const players = Array(...state.players);\n      players[playerIndex].words.push({ type: \"nuke\" });\n      return { nukers, bag, board, scooched: undefined };\n    })\n  }\n\n  private onPass = () => {\n    this.setState((state) => {\n      let playerIndex = state.playerIndex;\n      const passers = Array(...state.passers);\n      if (passers.includes(playerIndex)) {\n        return { ...state, word: [], board: state.original, reordered: [], over: true };\n      } else {\n        passers.push(playerIndex);\n        const players = Array(...state.players);\n        players[playerIndex].words.push({ type: \"pass\" });\n        playerIndex = (playerIndex + 1) % state.players.length;\n        return { ...state, word: [], board: state.original, reordered: [], playerIndex, passers, scooched: undefined };\n      }\n    });\n  }\n\n  private onPlay = () => {\n    this.setState((state) => {\n      const board = Array(...state.board);\n      const word = Array(...state.word);\n      const playedWord: IPlayedTile[] = [];\n      let points = 0;\n      let bonusPoints = 0;\n      while (word.length > 0) {\n        const tile = word.pop()!;\n        const letter = tile.letter;\n        const tilePoints = this.tilePoints(tile);\n        const tileBonusPoints = this.bonusPoints(tile);\n        playedWord.unshift({ id: tile.id, letter, points: tilePoints, bonusPoints: tileBonusPoints });\n        points += (tilePoints || 0);\n        bonusPoints += (tileBonusPoints || 0);\n        let seed = board.indexOf(tile);\n        const drops: ITile[] = [];\n        while (seed >= 0) {\n          const drop = seed - 4;\n          if (drop >= 0) {\n            board[seed] = board[drop];\n            board[seed].drop++;\n          } else {\n            board[seed] = { type: \"drop\", id: `dropping-${tile.id}`, drop: board[seed].drop + 1 } as ITile;\n          }\n          drops.push(board[seed]);\n          seed = drop;\n        }\n        drops.forEach((tile) => this.drop(tile, tile.drop));\n      }\n      const players = Array(...state.players);\n      const player = players[state.playerIndex];\n      const playMove: IPlay = {\n        type: \"play\",\n        word: playedWord,\n        points,\n        bonusPoints,\n        goals: [],\n      };\n      player.words.push(playMove);\n      this.state.goals.forEach((goal) => {\n        if (goal.check(playMove)) {\n          this.announceGoal(goal);\n          playMove.goals.push(goal);\n          playMove.bonusPoints += goal.points;\n        }\n      });\n      const goals = without(this.state.goals, ...playMove.goals);\n      const playerIndex = (state.playerIndex + 1) % players.length;\n      return { board, word, players, playerIndex, original: Array(...board), reordered: [], passers: [], scooched: undefined, goals };\n    })\n  }\n\n  private pendingDrops: ITile[] = [];\n  private clearDrops: ITile[] = [];\n\n  private announceGoal(goal: IGoal) {\n    this.announce(`${goal.type} +${goal.points}`, goal.description);\n  }\n\n  private drop(tile: ITile, distance: number) {\n    this.pendingDrops.push(tile);\n    tile.drop = distance;\n    setTimeout(() => {\n      const i = this.pendingDrops.indexOf(tile);\n      this.pendingDrops.splice(i, 1)\n      this.clearDrops.push(tile);\n    }, tile.drop * 1000);\n  }\n\n  private announce(title: string, message: string) {\n    this.setState((state) => {\n      const {announcements} = state;\n      announcements.push({title, message, key: ++UID});\n      return {announcements};\n    })\n  }\n}\n\nexport default App;\n","import { ITile } from './App';\nimport { IPlay } from \"./Move\";\n\ntype GoalType = 'Get Moving' | 'Over It' | 'Double Up' | 'Up Front' | 'Cheapskate' | 'Shortie';\n\nexport interface IGoal {\n    type: GoalType;\n    description: string;\n    points: number;\n    possible(board: ITile[]): boolean | \"maybe\";\n    check(move: IPlay): boolean;\n}\n\nabstract class Goal implements IGoal {\n    abstract type: GoalType;\n    abstract get description(): string;\n    abstract points: number;\n    possible(board: ITile[]) {\n        const letters = board.map((t) => t.letter).join(\"\");\n        return this.possibleWithBoard(letters);\n    }\n    check(move: IPlay): boolean {\n        const word = move.word.map((t) => t.letter).join(\"\");\n        return this.checkWord(word);\n    }\n    abstract possibleWithBoard(board: string): boolean;\n    abstract checkWord(word: string): boolean;\n}\n\nexport class VerbGoal extends Goal {\n    type = \"Get Moving\" as GoalType;\n    description = \"Play something ending in 'ing'\";\n    points = 10;\n    possibleWithBoard(board: string) {\n        return board.includes(\"I\") &&board.includes(\"N\") &&board.includes(\"G\");        \n    }\n    checkWord(word: string): boolean {\n        return word.endsWith(\"ING\");\n    }\n    public static fromJson(json: any) {\n        return new VerbGoal();\n    }\n}\n\nexport class VerbPastGoal extends Goal {\n    type = \"Over It\" as GoalType;\n    description = \"Play something ending in 'ed'\";\n    points = 8;\n    possibleWithBoard(board: string) {\n        return board.includes(\"E\") &&board.includes(\"D\");        \n    }\n    checkWord(word: string): boolean {\n        return word.endsWith(\"ED\");\n    }\n    public static fromJson(json: any) {\n        return new VerbPastGoal();\n    }\n}\n\nexport class DoublesGoal extends Goal {\n    type = \"Double Up\" as GoalType;\n    get description() { return `Play something with two '${this.letter}'s`; }\n    points = 7;\n    private readonly letter: string;\n    constructor(letter: string) {\n        super();\n        this.letter = letter;\n    }\n    possibleWithBoard(board: string) {\n        return board.split(this.letter).length >= 3;\n    }\n    checkWord(word: string): boolean {\n        return word.split(this.letter).length >= 3;\n    }\n    public static fromJson(json: any) {\n        return new DoublesGoal(json.letter);\n    }\n}\n\nexport class StartsWithGoal extends Goal {\n    type = \"Up Front\" as GoalType;\n    get description() { return `Play something that starts with '${this.letter}'`; }\n    points = 5;\n    private readonly letter: string;\n    constructor(letter: string) {\n        super();\n        this.letter = letter;\n    }\n    possibleWithBoard(board: string) {\n        return board.split(this.letter).length >= 2;\n    }\n    checkWord(word: string): boolean {\n        return word.startsWith(this.letter);\n    }\n    public static fromJson(json: any) {\n        return new StartsWithGoal(json.letter);\n    }\n}\n\nexport class CheapskateGoal implements IGoal {\n    possible(board: ITile[]) {\n        if (board.filter((e) => (e.points || 0) < 2).length >= 3) {\n            return \"maybe\";\n        }\n        return false;\n    }\n    check(move: IPlay): boolean {\n        return !move.word.some((t) => (t.points || 0) > 2);\n    }\n    type = \"Cheapskate\" as GoalType;\n    get description() { return `Only use tiles worth one or two points`; }\n    points = 10;\n    public static fromJson(json: any) {\n        return new CheapskateGoal();\n    }\n}\n\nexport class LengthGoal implements IGoal {\n    length: number;\n    constructor(length: number) {\n        this.length = length;\n    }\n    possible(board: ITile[]) {\n        return true;\n    }\n    check(move: IPlay): boolean {\n        return move.word.length === this.length;\n    }\n    type = \"Shortie\" as GoalType;\n    get description() { return `Play something ${this.length} letters long`; }\n    points = 10;\n    public static fromJson(json: any) {\n        return new LengthGoal(json.length);\n    }\n}\n","import { ITile } from 'App';\nimport { getPrefixInfo } from './isWord';\n\nexport default class WordFinder {\n    private board: ITile[];\n    private width: number;\n    private onWordFound: (word: ITile[]) => void;\n\n    constructor(board: ITile[], width: number, onWordFound: (word: ITile[]) => void) {\n        this.board = board;\n        this.width = width;\n        this.onWordFound = onWordFound;\n    }\n\n    public findWords() {\n        for (let y = 0; y < this.board.length / this.width; y++) {\n            for (let x = 0; x < this.width; x++) {\n                const seed = this.width * y + x;\n                this.search(seed, []);\n            }            \n        }\n    }\n\n    private adjacent(pos: number) {\n        const {board, width} = this;\n        const x = pos % width;\n        const y = (pos - x) / width;\n        const result: number[] = [];\n        if (x > 0) {\n            result.push(pos - 1);\n            if (y > 0) {\n                result.push(pos - 1 - width);\n            }\n            if (y < (board.length / width) - 1) {\n                result.push(pos - 1 + width);\n            }\n        }\n        if (y > 0) {\n            result.push(pos - width);\n        }\n        if (x < width - 1) {\n            result.push(pos + 1);\n            if (y > 0) {\n                result.push(pos + 1 - width);\n            }\n            if (y < (board.length / width) - 1) {\n                result.push(pos + 1 + width);\n            }\n        }\n        if (y < (board.length / width) - 1) {\n            result.push(pos + width);\n        }\n        return result;\n    }\n\n    private adjacentFree(pos: number, word: ITile[]) {\n        return this.adjacent(pos).filter((e) => {\n            const tile = this.board[e];\n            if (tile.type !== \"letter\") {\n                return false;\n            }\n            if (word.includes(tile)) {\n                return false;\n            }\n            return true;\n        });\n    }\n\n    private search(pos: number, word: ITile[]) {\n        const tile = this.board[pos];\n        if (tile.type !== \"letter\") {\n            return;\n        }\n        word.push(tile);\n        const info = getPrefixInfo(word);\n        if (info === undefined) {\n            return;\n        }\n        if (info === true || info.valid) {\n            this.onWordFound(word);\n        }\n        if (info !== true) {\n            const af = this.adjacentFree(pos, word);\n            af.forEach((nextPos) => {\n                const nextTile = this.board[nextPos];\n                if (info.next.includes(nextTile.letter.toLowerCase())) {\n                    this.search(nextPos, [...word]);\n                }\n            });\n        }\n    }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}