{"version":3,"sources":["tile.svg","Goals.ts","TileSetComponent.tsx","AccordionCell.tsx","RulesComponent.tsx","isWord.tsx","TileDefinitions.tsx","WordFinder.ts","MenuItemComponent.tsx","MainMenuComponent.tsx","Globals.ts","App.tsx","InviteComponent.tsx","serviceWorker.ts","index.tsx"],"names":["module","exports","__webpack_require__","p","Goal","type","points","board","letters","map","t","letter","join","this","possibleWithBoard","move","word","checkWord","VerbGoal","_Goal","_getPrototypeOf2","_this","Object","classCallCheck","_len","arguments","length","args","Array","_key","possibleConstructorReturn","getPrototypeOf","call","apply","concat","description","inherits","createClass","key","value","includes","endsWith","json","VerbPastGoal","_Goal2","_getPrototypeOf3","_this2","_len3","_key3","DoublesGoal","_Goal3","_this3","get","split","StartsWithGoal","_Goal4","_this4","startsWith","CheapskateGoal","filter","e","some","LengthGoal","TileDefinitionComponent","observer","_this$props","props","remaining","tileDefinition","count","react_default","a","createElement","className","React","Component","TileSetComponent","_class2","_React$Component2","_this$props$tileSet","tileSet","name","tiles","Card_default","Header","Body","index","undefined","bag","tile","TileSetComponent_TileDefinitionComponent","AccordionCell","onClick","onSelect","eventKey","Accordion_default","Toggle","as","Card","style","cursor","title","Collapse","children","SESSION_STORAGE_KEY","CURRENT_VERSION","RulesComponent","activeEventKey","setState","state","stateString","sessionStorage","getItem","JSON","parse","version","_unused","removeItem","setItem","stringify","options","changeOptions","resetOptions","defaultActiveKey","oneScoochPerTurn","Badge","variant","bonusForLongerWords","Badge_default","src_TileSetComponent","Form_default","Check","id","label","checked","onChange","originalOptions","objectSpread","Button_default","href","target","rel","TRIE","require","find","forEach","toLocaleLowerCase","TileDefinition","TileDefinitions_class","initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","applyDecoratedDescriptor","prototype","observable","configurable","enumerable","writable","initializer","TileDefinitions","_class3","TileSet","_descriptor4","_descriptor5","WordFinder","width","onWordFound","y","x","seed","search","pos","result","push","adjacent","info","prefix","next","getOwnPropertyNames","validIndex","indexOf","valid","splice","getPrefixInfo","adjacentFree","nextPos","nextTile","toLowerCase","toConsumableArray","MenuItemComponent","icon","badge","disabled","onClickDisabled","react","Row_default","compact","Col_default","xs","Figure_default","Image","src","pill","MainMenuComponent","show","hide","canReset","reset","canPass","passWillEndGame","pass","usedNuke","noMoreTiles","nuke","nukeTitle","Modal_default","onHide","backdrop","MenuItemComponent_MenuItemComponent","Error","phone","window","innerWidth","MoveTypes","InviteComponent","gameUrl","playerName","changePlayerName","play","dismiss","scrollable","closeButton","Title","lib_default","size","Caption","Group","Label","Control","placeholder","DEFAULT_PLAYER_NAME","event","Footer","MOVE_VARIANTS","DEFAULT_OPTIONS","UID","classNames","classes","playerScore","player","words","i","bonusPoints","reduce","b","getTileSet","tileSetName","TileSets","newGame","players","data","j","drop","menuState","loading","gameStateVersion","gameId","uuid","playerIndex","original","reordered","nukers","passers","over","goals","announcements","JSON_TO_URL_DATA","APP_ID","App","_React$Component","automation","loadGameId","forcePushGameData","batonTimeout","tickInterval","pollInterval","automateInterval","pushImmediate","getToken","auth","password","deviceIdentifier","userId","authUserId","fetch","method","body","appId","headers","Content-Type","then","response","status","console","error","statusText","token","onAuthenticated","catch","localStorage","setInterval","poll","automate","pullGameData","lastSavedState","updateProhibited","gameStateLocked","newBaton","myUserId","timeout","Date","now","boardStateSource","stateToJson","boardState","needsPush","diff","warn","stateChangesWhileNotMyTurn","baton","Authorization","accessType","meta","onExchange","aIndex","findIndex","bIndex","newIndex","scooched","change","canSelect","seedTile","indexRow","Math","floor","seedRow","abs","canScooch","keyA","keyB","getIndex","tick","myPlayer","_loop","_i","space","random","pendingDrops","clearDrops","pop","forceUpdate","availableLetters","sample","uniqBy","shift","onClickItem","onNuke","onPass","onPlay","_this$state","canNuke","automated","possibilities","findWords","sort","tilePoints","tileSelected","onSmear","toString","preserveIndex","tileToDeselect","smeared","showMenu","open","hideMenu","onReset","playedWord","tileBonusPoints","unshift","drops","playMove","goal","check","announceGoal","without","query","queryString","location","_response$meta","hydrateAppState","ensureParticipant","prevProps","prevState","clearTimeout","setTimeout","solo","history","pushState","path","baseState","omit","clearInterval","unassignedPlayer","Alert_default","Heading","selectableLetters","onDone","canPlay","playLabel","isWord","pendingMove","scoredPlayers","score","overHeader","stars","playedTile","starsString","Container_default","fluid","renderModal","sm","Fragment","itIsMyTurn","ButtonGroup_default","item","backgroundImage","backgroundSize","backgroundRepeat","currentPlayer","humanizeDuration","onAnimationEnd","message","SlideGrid","canExchange","tap","done","smear","exchange","possible","md","isCurrentPlayer","wordContent","url","stuff","Blob","URL","revokeObjectURL","createObjectURL","jsonToUrl","RulesComponent_RulesComponent","_this$state2","renderQrDialog","renderMainMenu","_this5","InviteComponent_InviteComponent","passWillResign","MainMenuComponent_MainMenuComponent","assign","announce","distance","_this6","_this7","zid","_this8","_loop2","_loop3","hydrateGoals","fromJson","Boolean","hostname","match","ReactDOM","render","src_App_0","document","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.2c8734f2.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/tile.e1eb2eab.svg\";","import { ITile } from './App';\nimport { IPlay } from \"./Move\";\n\ntype GoalType = 'Get Moving' | 'Over It' | 'Double Up' | 'Up Front' | 'Cheapskate' | 'Shortie';\n\nexport interface IGoal {\n    type: GoalType;\n    description: string;\n    points: number;\n    possible(board: ITile[]): boolean | \"maybe\";\n    check(move: IPlay): boolean;\n}\n\nabstract class Goal implements IGoal {\n    abstract type: GoalType;\n    abstract get description(): string;\n    abstract points: number;\n    possible(board: ITile[]) {\n        const letters = board.map((t) => t.letter).join(\"\");\n        return this.possibleWithBoard(letters);\n    }\n    check(move: IPlay): boolean {\n        const word = move.word.map((t) => t.letter).join(\"\");\n        return this.checkWord(word);\n    }\n    abstract possibleWithBoard(board: string): boolean;\n    abstract checkWord(word: string): boolean;\n}\n\nexport class VerbGoal extends Goal {\n    type = \"Get Moving\" as GoalType;\n    description = \"Play something ending in 'ing'\";\n    points = 10;\n    possibleWithBoard(board: string) {\n        return board.includes(\"I\") &&board.includes(\"N\") &&board.includes(\"G\");        \n    }\n    checkWord(word: string): boolean {\n        return word.endsWith(\"ING\");\n    }\n    public static fromJson(json: any) {\n        return new VerbGoal();\n    }\n}\n\nexport class VerbPastGoal extends Goal {\n    type = \"Over It\" as GoalType;\n    description = \"Play something ending in 'ed'\";\n    points = 8;\n    possibleWithBoard(board: string) {\n        return board.includes(\"E\") &&board.includes(\"D\");        \n    }\n    checkWord(word: string): boolean {\n        return word.endsWith(\"ED\");\n    }\n    public static fromJson(json: any) {\n        return new VerbPastGoal();\n    }\n}\n\nexport class DoublesGoal extends Goal {\n    type = \"Double Up\" as GoalType;\n    get description() { return `Play something with two '${this.letter}'s`; }\n    points = 7;\n    private readonly letter: string;\n    constructor(letter: string) {\n        super();\n        this.letter = letter;\n    }\n    possibleWithBoard(board: string) {\n        return board.split(this.letter).length >= 3;\n    }\n    checkWord(word: string): boolean {\n        return word.split(this.letter).length >= 3;\n    }\n    public static fromJson(json: any) {\n        return new DoublesGoal(json.letter);\n    }\n}\n\nexport class StartsWithGoal extends Goal {\n    type = \"Up Front\" as GoalType;\n    get description() { return `Play something that starts with '${this.letter}'`; }\n    points = 5;\n    private readonly letter: string;\n    constructor(letter: string) {\n        super();\n        this.letter = letter;\n    }\n    possibleWithBoard(board: string) {\n        return board.split(this.letter).length >= 2;\n    }\n    checkWord(word: string): boolean {\n        return word.startsWith(this.letter);\n    }\n    public static fromJson(json: any) {\n        return new StartsWithGoal(json.letter);\n    }\n}\n\nexport class CheapskateGoal implements IGoal {\n    possible(board: ITile[]) {\n        if (board.filter((e) => (e.points || 0) < 2).length >= 3) {\n            return \"maybe\";\n        }\n        return false;\n    }\n    check(move: IPlay): boolean {\n        return !move.word.some((t) => (t.points || 0) > 2);\n    }\n    type = \"Cheapskate\" as GoalType;\n    get description() { return `Only use tiles worth one or two points`; }\n    points = 10;\n    public static fromJson(json: any) {\n        return new CheapskateGoal();\n    }\n}\n\nexport class LengthGoal implements IGoal {\n    length: number;\n    constructor(length: number) {\n        this.length = length;\n    }\n    possible(board: ITile[]) {\n        return true;\n    }\n    check(move: IPlay): boolean {\n        return move.word.length === this.length;\n    }\n    type = \"Shortie\" as GoalType;\n    get description() { return `Play something ${this.length} letters long`; }\n    points = 10;\n    public static fromJson(json: any) {\n        return new LengthGoal(json.length);\n    }\n}\n","import React from \"react\";\nimport { observer } from \"mobx-react\";\nimport { ITileSet, ITileDefinition } from \"TileDefinitions\";\nimport Card from \"react-bootstrap/Card\";\nimport { ITile } from \"App\";\n\ninterface ITileSetComponentProps {\n    tileSet: ITileSet;\n    bag?: ITile[];\n}\n\ninterface ITileSetComponentState {\n\n}\n\n@observer\nclass TileDefinitionComponent extends React.Component<{ tileDefinition: ITileDefinition, remaining?: number }> {\n    public render() {\n        const { remaining, tileDefinition } = this.props;\n        const { letter, points, count } = tileDefinition;\n        return <div className=\"tile-definition\">\n            <div className=\"tile\">\n                <div className=\"field\">\n                    <div className=\"letter\">{letter}</div>\n                    <div className=\"points\">{points}</div>\n                </div>\n            </div>\n            &nbsp;x&nbsp;{remaining ? `${remaining}/` : \"\"}{count}\n        </div>\n    }\n}\n\n@observer\nexport class TileSetComponent extends React.Component<ITileSetComponentProps, ITileSetComponentState> {\n    public render() {\n        const { name, tiles } = this.props.tileSet;\n        return <Card className=\"moves\">\n            <Card.Header>{name}</Card.Header>\n            <Card.Body>\n                {tiles.map((tileDefinition, index) => {\n                    let remaining: number | undefined = undefined;\n                    if (this.props.bag) {\n                        remaining = this.props.bag.filter((tile) => tile.letter === tileDefinition.letter).length;\n                    }\n                    return <TileDefinitionComponent\n                        key={index}\n                        tileDefinition={tileDefinition}\n                        remaining={remaining} />;\n                })}\n            </Card.Body>\n        </Card>\n    }\n}\n\nexport default TileSetComponent;\n","import React from 'react';\nimport Accordion from 'react-bootstrap/Accordion';\nimport Card from 'react-bootstrap/Card';\n\nexport default function AccordionCell(props: {\n  eventKey: string;\n  title: React.ReactNode;\n  children?: React.ReactNode;\n  onSelect(eventKey: string): void;\n}) {\n    const onClick = props.onSelect ? () => props.onSelect(props.eventKey) : undefined;\n  return <Card>\n    <Accordion.Toggle as={Card.Header} eventKey={props.eventKey} style={{ cursor: \"pointer\" }} onClick={onClick}>\n      {props.title}\n    </Accordion.Toggle>\n    <Accordion.Collapse eventKey={props.eventKey}>\n      <Card.Body>\n        {props.children}\n      </Card.Body>\n    </Accordion.Collapse>\n  </Card>;\n}\n","import React from \"react\";\nimport Accordion from \"react-bootstrap/Accordion\";\nimport Form from 'react-bootstrap/Form';\nimport TileSetComponent from 'TileSetComponent';\nimport { IScoochOptions, ITile } from \"App\";\nimport Badge from \"react-bootstrap/Badge\";\nimport Button from \"react-bootstrap/Button\";\nimport AccordionCell from \"AccordionCell\";\nimport { TileSet } from \"TileDefinitions\";\n\ninterface IRulesProps {\n    options: IScoochOptions;\n    tileSet: TileSet;\n    bag: ITile[];\n\n    changeOptions(change: (options: IScoochOptions) => IScoochOptions): void;\n    resetOptions(): void;\n}\n\ninterface IRulesState {\n  version: string;\n  activeEventKey: string | undefined;\n}\n\nconst SESSION_STORAGE_KEY = \"rulesState\";\n\nconst CURRENT_VERSION = \"0.4.2\";\n\nexport default class RulesComponent extends React.Component<IRulesProps, IRulesState> {    \n    constructor(props: IRulesProps) {\n        super(props);\n        const stateString = sessionStorage.getItem(SESSION_STORAGE_KEY);\n        if (stateString) {\n            try {\n                const state = JSON.parse(stateString) as IRulesState;\n                if (state.version !== CURRENT_VERSION) {\n                  state.activeEventKey = \"help-new\";\n                  state.version = CURRENT_VERSION;\n                }\n                this.state = state;\n                return;\n            } catch {\n                sessionStorage.removeItem(SESSION_STORAGE_KEY);\n            }\n        }\n        this.state = { activeEventKey: \"help-new\", version: CURRENT_VERSION };\n    }\n\n    public componentDidUpdate() {\n        sessionStorage.setItem(SESSION_STORAGE_KEY, JSON.stringify(this.state));\n    }\n\n    public render() {\n        const {options, tileSet, bag, changeOptions, resetOptions} = this.props;\n        return <Accordion className=\"mt-5\" defaultActiveKey={this.state.activeEventKey}>\n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-new\" title={`What’s New (v${CURRENT_VERSION})`}>\n          <dl>\n            <dt>Goals</dt>\n            <dd>There are now randomly-selected bonus goals shown below the play area. Complete them to earn bonus points!</dd>\n\n            <dt>Automation</dt>\n            <dd>Play against the computer, or have it take over for someone! Select the \"Automated\" option under a player’s name.</dd>\n          </dl>\n        </AccordionCell>\n\n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-words\" title=\"Making Words\">\n          <ul>\n            <li>Click <span className=\"field\">tiles</span> to add them to your word.</li>\n            <li>Click a <span className=\"field selected\">selected</span> tile to remove it from your word.</li>\n            <li>You may only add tiles <span className=\"field\">close</span> to the last letter of your word — other tiles are <span className=\"field unselectable\">too far</span>.</li>\n            <li>Never fear! You may scooch tiles around to make the word you want! Whether <span className=\"field\">near</span> or <span className=\"field unselectable\">far</span>, just drag tiles to where you need them.</li>\n            <li>When you scooch a tile, it switches places with its neighbor, and both tiles lose their point values.</li>\n            {options.oneScoochPerTurn && <li><Accordion.Toggle as={Badge} eventKey=\"options\" variant=\"secondary\">Option</Accordion.Toggle> You may only scooch one tile per turn, though you can move it as far as you want, and don't have to do it all at once.</li>}\n            {options.bonusForLongerWords && <li><Accordion.Toggle as={Badge} eventKey=\"options\" variant=\"secondary\">Option</Accordion.Toggle> Play longer words to get bonus points!</li>}\n          </ul>\n        </AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-end-turn\" title=\"Ending Your Turn\"><p>\n          Once you’re happy with your word, click the <Badge variant=\"primary\">Play Word</Badge> button.\n          e tiles that make up your word go onto the scoreboard,\n            tiles left on the board drop down into their places,\n              w tiles slide in from the top to fill up the board.\n                s you scooched but didn’t use get their points back,\n          and it’s the next player’s turn!\n        </p></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-nuke\" title=\"The Nuclear Option\"><p>\n          Also known as “flipping the table,” once per game each player may use the <Badge variant=\"warning\">Nuke</Badge> button to throw all the tiles on the board back into the bag and draw new ones.\n          There is no penalty — you won’t lose your turn or any points — but you may only use the nuclear option once!\n        </p></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-end\" title=\"End of the Game\"><p>\n          When the tile bag is empty, you’ll notice empty spaces left on the board after tiles drop down.\n          (You can't scooch with those empty spaces.)\n          Eventually, there won’t be more words to make, and you’ll have to <Badge variant=\"secondary\">Pass</Badge>.\n          After all players pass in a row, the game ends, and the player with the most points wins!\n        </p></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-tiles\" title=\"Tile Distribution\">\n          <TileSetComponent tileSet={tileSet} bag={bag} />\n        </AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"help-proto\" title=\"Prototype Notes\"><dl>\n          <dt>Scooch Limit</dt>\n          <dd>\n            When playing with the physical prototype, we generally made the rule that you could only scooch one tile\n            per turn, though you could move it as far as you wanted.Right now this version does <i>not</i> limit you\n            to a single scooch per turn, but that may change.\n          </dd>\n          <dt>Point Values</dt>\n          <dd>\n            The big tiles (\n            <span className=\"field\">J</span>\n            <span className=\"field\">Q</span>\n            <span className=\"field\">X</span>\n            <span className=\"field\">Z</span>) are way too valuable — without the riposte available in games like\n            rabble™ and Words With Friends™ they’re completely dominant in final scoring.I did run a test\n                 physical prototype where scores were compressed, with the highest score being five, and the\n                  re far more balanced (and felt fair) but were also boring.I need to find a blance — perhaps\n            with the big tiles scoring seven points — to restore the excitement and variability.\n          </dd>\n        </dl></AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"options\" title=\"Options\">\n          <Form.Check type=\"checkbox\" id=\"on-scooch\" label=\"One scooch per turn\" checked={!!options.oneScoochPerTurn} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.oneScoochPerTurn = !options.oneScoochPerTurn;\n            return options;\n          })} />\n          <Form.Check type=\"radio\" id=\"on-length-none\" label=\"No bonus points for longer words\" checked={!!options.bonusForLongerWords === false} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.bonusForLongerWords = false;\n            return options;\n          })} />\n          <Form.Check type=\"radio\" id=\"on-length\" label=\"One bonus point for each letter over four tiles\" checked={options.bonusForLongerWords === \"constant\"} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.bonusForLongerWords = \"constant\";\n            return options;\n          })} />\n          <Form.Check type=\"radio\" id=\"on-length-linear\" label=\"Increasing bonus points for words over three tiles\" checked={options.bonusForLongerWords === \"linear\"} onChange={() => changeOptions((originalOptions) => {\n            const options = {...originalOptions};\n            options.bonusForLongerWords = \"linear\";\n            return options;\n          })} />\n          <Button onClick={() => resetOptions()}>Reset</Button>\n        </AccordionCell>\n    \n        <AccordionCell onSelect={this.onSelect} eventKey=\"dictionary\" title=\"Acceptable Words\">\n          <p>\n            Words need to be at least three letters long and are checked against the <a href=\"https://diginoodles.com/The_English_Open_Word_List_%28EOWL%29\" target=\"_blank\" rel=\"noopener noreferrer\">English Open Word List</a> (EOWL).\n          </p>\n          <dl>\n            <dt>\n              UK Advanced Cryptics Dictionary Licensing Information\n            </dt>\n            <dd>\n              Copyright © J Ross Beresford 1993-1999. All Rights Reserved.The following restriction is placed on the use of this publication: if the UK Advanced Cryptics Dictionary is used in a software package or redistributed in any form, the copyright notice must be prominently displayed and the text of this document must be included verbatim.\n            </dd>\n            <dt>\n              <a href=\"https://diginoodles.com/The_English_Open_Word_List_%28EOWL%29\" target=\"_blank\" rel=\"noopener noreferrer\">The English Open Word List</a>\n            </dt>\n            <dd>\n              The EOWL was developed by Ken Loge, and based on the above UKACD, but he explicitly placed no additional rescrtictions on its use.\n            </dd>\n          </dl>\n    \n        </AccordionCell>\n      </Accordion>;\n    }\n\n    private onSelect = (activeEventKey: string) => this.setState((state) => {\n        if (state.activeEventKey === activeEventKey) {\n            return {activeEventKey: undefined};\n        } else {\n            return {activeEventKey};\n        }\n    });\n}\n","export type TrieEntry = Trie | 1 | undefined;\nexport type Word = Array<{ letter: string }>;\n\ninterface Trie {\n  [key: string]: TrieEntry,\n}\n\nconst TRIE: Trie = require(\"./trie.json\");\n\nfunction find(word: Word) {\n  let t: TrieEntry = TRIE;\n  word.forEach((tile) => {\n    if (typeof t === \"object\") {\n      t = t[tile.letter.toLocaleLowerCase()];\n    }\n  });\n  return t;\n}\n\nexport default function isWord(word: Word) {\n  const t = find(word);\n  return typeof t === \"object\" && t[\"_\"] === 1;\n}\n\nexport function getPrefixInfo(prefix: Word) {\n  const t = find(prefix);\n  if (typeof t !== \"object\") {\n    return undefined;\n  }\n  const next = Object.getOwnPropertyNames(t);\n  const validIndex = next.indexOf(\"_\");\n  const valid = validIndex >= 0;\n  if (valid) {\n    next.splice(validIndex, 1);\n  }\n  if (next.length === 0) {\n    return true;\n  }\n  return { valid, next }\n}\n","import {observable} from \"mobx\";\n\nexport interface ITileDefinition {\n  letter: string;\n  count: number;\n  points: number;\n}\n\nexport class TileDefinition implements ITileDefinition {\n  @observable\n  public letter: string;\n\n  @observable\n  public count: number;\n\n  @observable\n  public points: number;\n\n  constructor(props: ITileDefinition) {\n    this.letter = props.letter;\n    this.count = props.count;\n    this.points = props.points;\n  }\n}\n\nexport interface ITileSet {\n  name: string;\n  tiles: ITileDefinition[];\n}\n\nexport class TileSet implements ITileSet {\n  @observable\n  public name: string;\n  \n  @observable\n  public tiles: ITileDefinition[];\n\n  constructor(name?: string, tiles?: ITileDefinition[]) {\n    this.name = name || \"Untitled\";\n    this.tiles = tiles || [];\n  }\n}\n\nconst DefaultTileDefinitions = [\n{\n    letter: \"A\",\n    count: 9,\n    points: 1,\n  },\n  {\n    letter: \"B\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"C\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"D\",\n    count: 5,\n    points: 2,\n  },\n  {\n    letter: \"E\",\n    count: 13,\n    points: 1,\n  },\n  {\n    letter: \"F\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"G\",\n    count: 3,\n    points: 3,\n  },\n  {\n    letter: \"H\",\n    count: 4,\n    points: 3,\n  },\n  {\n    letter: \"I\",\n    count: 6,\n    points: 1,\n  },\n  {\n    letter: \"J\",\n    count: 1,\n    points: 10,\n  },\n  {\n    letter: \"K\",\n    count: 1,\n    points: 5,\n  },\n  {\n    letter: \"L\",\n    count: 4,\n    points: 2,\n  },\n  {\n    letter: \"M\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"N\",\n    count: 5,\n    points: 2,\n  },\n  {\n    letter: \"O\",\n    count: 8,\n    points: 1,\n  },\n  {\n    letter: \"P\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"Q\",\n    count: 1,\n    points: 10,\n  },\n  {\n    letter: \"R\",\n    count: 6,\n    points: 1,\n  },\n  {\n    letter: \"S\",\n    count: 5,\n    points: 1,\n  },\n  {\n    letter: \"T\",\n    count: 7,\n    points: 1,\n  },\n  {\n    letter: \"U\",\n    count: 4,\n    points: 2,\n  },\n  {\n    letter: \"V\",\n    count: 2,\n    points: 5,\n  },\n  {\n    letter: \"W\",\n    count: 2,\n    points: 4,\n  },\n  {\n    letter: \"X\",\n    count: 1,\n    points: 8,\n  },\n  {\n    letter: \"Y\",\n    count: 2,\n    points: 3,\n  },\n  {\n    letter: \"Z\",\n    count: 1,\n    points: 10,\n  },\n].map((e) => new TileDefinition(e));\n\nconst DefaultTileSet: ITileSet = new TileSet(\"Default\",  DefaultTileDefinitions)\n\nexport default [DefaultTileSet];\n","import { ITile } from 'App';\nimport { getPrefixInfo } from './isWord';\n\nexport default class WordFinder {\n    private board: ITile[];\n    private width: number;\n    private onWordFound: (word: ITile[]) => void;\n\n    constructor(board: ITile[], width: number, onWordFound: (word: ITile[]) => void) {\n        this.board = board;\n        this.width = width;\n        this.onWordFound = onWordFound;\n    }\n\n    public findWords() {\n        for (let y = 0; y < this.board.length / this.width; y++) {\n            for (let x = 0; x < this.width; x++) {\n                const seed = this.width * y + x;\n                this.search(seed, []);\n            }            \n        }\n    }\n\n    private adjacent(pos: number) {\n        const {board, width} = this;\n        const x = pos % width;\n        const y = (pos - x) / width;\n        const result: number[] = [];\n        if (x > 0) {\n            result.push(pos - 1);\n            if (y > 0) {\n                result.push(pos - 1 - width);\n            }\n            if (y < (board.length / width) - 1) {\n                result.push(pos - 1 + width);\n            }\n        }\n        if (y > 0) {\n            result.push(pos - width);\n        }\n        if (x < width - 1) {\n            result.push(pos + 1);\n            if (y > 0) {\n                result.push(pos + 1 - width);\n            }\n            if (y < (board.length / width) - 1) {\n                result.push(pos + 1 + width);\n            }\n        }\n        if (y < (board.length / width) - 1) {\n            result.push(pos + width);\n        }\n        return result;\n    }\n\n    private adjacentFree(pos: number, word: ITile[]) {\n        return this.adjacent(pos).filter((e) => {\n            const tile = this.board[e];\n            if (tile.type !== \"letter\") {\n                return false;\n            }\n            if (word.includes(tile)) {\n                return false;\n            }\n            return true;\n        });\n    }\n\n    private search(pos: number, word: ITile[]) {\n        const tile = this.board[pos];\n        if (tile.type !== \"letter\") {\n            return;\n        }\n        word.push(tile);\n        const info = getPrefixInfo(word);\n        if (info === undefined) {\n            return;\n        }\n        if (info === true || info.valid) {\n            this.onWordFound(word);\n        }\n        if (info !== true) {\n            const af = this.adjacentFree(pos, word);\n            af.forEach((nextPos) => {\n                const nextTile = this.board[nextPos];\n                if (info.next.includes(nextTile.letter.toLowerCase())) {\n                    this.search(nextPos, [...word]);\n                }\n            });\n        }\n    }\n}\n","import Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport * as React from \"react\";\nimport Figure from \"react-bootstrap/Figure\";\nimport Badge from \"react-bootstrap/Badge\";\nimport compact from \"lodash/compact\";\n\ninterface IMenuItemProps {\n    icon: string;\n    title: string;\n    description: string;\n    disabled?: boolean;\n    badge?: string | number;\n    onClick(): void;\n    onClickDisabled?(): void;\n}\n\nexport default class MenuItemComponent extends React.Component<IMenuItemProps> {\n    render() {\n        const {icon, badge, title, description, disabled, onClick, onClickDisabled} = this.props;\n        return <Row className={compact([\"menu-item\", disabled && \"disabled\"]).join(\" \")} onClick={disabled ? onClickDisabled : onClick}>\n            <Col xs={2} className=\"left\">\n                <Figure>\n                    <Figure.Image src={icon}/>\n                </Figure>\n            </Col>\n            <Col className={\"right flex-grow\"}>\n                <Row>\n                    <Col className={\"title flex-grow\"}>\n                        {title}\n                    </Col>\n                    <Col xs={\"auto\"}>\n                        {badge && <Badge variant={\"success\"} pill={true}>{badge}</Badge>}\n                    </Col>\n                </Row>\n                <Row className={\"description\"}>\n                    <Col className={\"flex-fill\"}>\n                        <span>\n                            {description}\n                        </span>\n                    </Col>\n                </Row>\n            </Col>\n        </Row>;\n    }\n}\n","import Modal from \"react-bootstrap/Modal\";\nimport \"Menus.css\";\nimport MenuItemComponent from \"./MenuItemComponent\";\nimport * as React from \"react\";\nimport tile from \"tile.svg\";\n\ninterface IMainMenuProps {\n    show: boolean;\n    hide(): void;\n\n    help?(section: \"how-to\"): void;\n\n    canReset: boolean;\n    reset(): void;\n\n    usedNuke: boolean;\n    noMoreTiles: boolean;\n    nuke(): void;\n\n    canPass: boolean;\n    passWillEndGame: boolean;\n    pass(): void;\n}\n\nexport default class MainMenuComponent extends React.Component<IMainMenuProps> {\n    public render() {\n        const {show, hide,\n\n            canReset, reset,\n            canPass, passWillEndGame, pass,\n\n            usedNuke, noMoreTiles, nuke} = this.props;\n\n        let nukeTitle = \"Discard all tiles and draw new ones. You may only do this once per game.\";\n        if (usedNuke) {\n            nukeTitle = \"You may only use the nuclear option once per game.\";\n        } else if (noMoreTiles) {\n            nukeTitle = \"It’s too late to use the nuclear option.\";\n        }\n\n        return <Modal className=\"main-menu\" show={show} onHide={hide} backdrop={true}>\n            <Modal.Body>\n                <MenuItemComponent\n                    title={\"How to Play\"}\n                    description={\"Getting started and rules of the game\"}\n                    icon={tile}\n                    disabled={true}\n                    onClick={() => {throw new Error(\"Not Implemented\")}}\n                />\n\n                <MenuItemComponent\n                    title={\"Dictionary\"}\n                    description={\"Information about which words are acceptable\"}\n                    icon={tile}\n                    disabled={true}\n                    onClick={() => {throw new Error(\"Not Implemented\")}}\n                />\n\n                <MenuItemComponent\n                    title={\"Tile Distribution\"}\n                    description={\"How many tiles there are of each letter and how many remain in the bag\"}\n                    icon={tile}\n                    disabled={true}\n                    onClick={() => {throw new Error(\"Not Implemented\")}}\n                />\n\n                <MenuItemComponent\n                    title={\"Reset\"}\n                    description={\"Return tiles to their original positions, restoring their point values.\"}\n                    icon={tile}\n                    disabled={!canReset}\n                    onClick={reset}\n                />\n\n                <MenuItemComponent\n                    title={passWillEndGame ? \"Pass\" : \"Finish\"}\n                    description={passWillEndGame ? \"Finish the game\" : \"No moves? Pass your turn\"}\n                    icon={tile}\n                    disabled={!canPass}\n                    onClick={pass}\n                />\n\n                <MenuItemComponent\n                    title={\"Nuke\"}\n                    description={nukeTitle}\n                    icon={tile}\n                    badge={usedNuke ? 0 : 1}\n                    disabled={usedNuke}\n                    onClick={nuke}\n                />\n\n                <MenuItemComponent\n                    title={\"Resign\"}\n                    description={\"End this game, but it counts as a loss\"}\n                    icon={tile}\n                    disabled={true}\n                    onClick={() => {throw new Error(\"Not Implemented\")}}\n                />\n            </Modal.Body>\n        </Modal>;\n    }\n}\n","export function phone() {\n    return window.innerWidth < 576;\n}\n","import SlideGrid from '@pyrogenic/slide-grid/lib/SlideGrid';\nimport * as diff from \"deep-diff\";\nimport {CheapskateGoal, DoublesGoal, IGoal, LengthGoal, StartsWithGoal, VerbGoal, VerbPastGoal} from 'Goals';\nimport humanizeDuration from \"humanize-duration\";\nimport compact from 'lodash/compact';\nimport omit from 'lodash/omit';\nimport sample from 'lodash/sample';\nimport uniqBy from 'lodash/uniqBy';\nimport without from 'lodash/without';\nimport * as queryString from \"querystring\";\nimport React from 'react';\nimport Alert from 'react-bootstrap/Alert';\nimport Badge from 'react-bootstrap/Badge';\nimport Button from 'react-bootstrap/Button';\nimport ButtonGroup from 'react-bootstrap/ButtonGroup';\nimport Card from 'react-bootstrap/Card';\nimport Col from 'react-bootstrap/Col';\nimport Container from 'react-bootstrap/Container';\nimport Form from 'react-bootstrap/Form';\nimport Row from 'react-bootstrap/Row';\nimport RulesComponent from 'RulesComponent';\nimport uuid from 'uuid/v4';\nimport './App.css';\nimport isWord from './isWord';\nimport {IPlay, IPlayedTile, Move} from './Move';\nimport tile from \"./tile.svg\";\nimport TileSets from './TileDefinitions';\nimport WordFinder from './WordFinder';\nimport MainMenuComponent from \"./MainMenuComponent\";\nimport InviteComponent from \"./InviteComponent\";\n\nconst PLAYER_NAME_KEY = \"PlayerName\";\n\nexport const DEFAULT_PLAYER_NAME = \"Anonymous\";\n\nexport interface ITile {\n  type: \"letter\" | \"space\" | \"drop\";\n  id: string;\n  letter: string;\n  points: number;\n  renderIndex?: number;\n  drop: number;\n}\n\nenum MoveTypes {\n  pass = \"pass\",\n  nuke = \"nuke\",\n  play = \"play\",\n}\n\ntype Variant = undefined\n  | 'primary'\n  | 'secondary'\n  | 'success'\n  | 'danger'\n  | 'warning'\n  | 'info'\n  | 'dark'\n  | 'light'\n  | 'link'\n  | 'outline-primary'\n  | 'outline-secondary'\n  | 'outline-success'\n  | 'outline-danger'\n  | 'outline-warning'\n  | 'outline-info'\n  | 'outline-dark'\n  | 'outline-light';\n\ntype BadgeVariant = Exclude<Variant, \"link\"\n  | \"outline-primary\"\n  | 'outline-secondary'\n  | 'outline-success'\n  | 'outline-danger'\n  | 'outline-warning'\n  | 'outline-info'\n  | 'outline-dark'\n  | 'outline-light'>;\n\nconst MOVE_VARIANTS: { [P in MoveTypes]: BadgeVariant } = {\n  play: \"primary\",\n  nuke: \"warning\",\n  pass: \"secondary\",\n};\n\ninterface IPlayer {\n  name: string;\n  userId?: string;\n  words: Move[];\n  automated?: boolean;\n}\n\nexport interface IScoochOptions {\n  solo?: boolean;\n  oneScoochPerTurn?: boolean;\n  tileSetName?: string;\n  bonusForLongerWords?: false | \"constant\" | \"linear\";\n}\n\nconst DEFAULT_OPTIONS: IScoochOptions = {\n  oneScoochPerTurn: true,\n  bonusForLongerWords: \"linear\",\n}\n\ntype IAutomationAction = {\n  type: \"tap\", a: string,\n} | {\n  type: \"scooch\",\n  a: string,\n  b: string,\n} | {\ntype: \"submit\" | \"wait\" | \"nuke\" | \"pass\",\n}\n\nlet UID = 1;\n\ninterface IMenuState {\n  open?: boolean;\n}\n\ninterface IAnnouncement {\n  key: number,\n  title: string,\n  message: string,\n}\n\n/**\n * State held in the conversation meta and thus shared between players\n */\n// TODO: unflatten IAppState to make code and logic easier to follow.\ninterface ISharedState {\n  /**\n   * Represents a \"reservation\" of the right to change game state.  Mostly it was to help people put their names in\n   * when it isn't their turn at the beginning, but may not actually be necessary if the version field is properly\n   * respected (i.e. checked agains the local state after join but before edit).\n   */\n  baton?: {\n    userId: string,\n    timeout: number,\n  },\n\n  /**\n   * Same as the conversation id\n   */\n  gameId: string;\n\n  /**\n   * Optimistic concurrency version number for {gameState}\n   */\n  gameStateVersion: number;\n\n  // Would be part of this object if not flattened into {IAppState}\n  // gameState: IGameState,\n}\n\ninterface IGameState {\n  players: IPlayer[];\n  playerIndex: number;\n  nukers: number[];\n  passers: number[];\n  over: boolean;\n  announcements: IAnnouncement[];\n  options: IScoochOptions;\n  bag: ITile[];\n  board: ITile[];\n  original: ITile[];\n  word: ITile[];\n  reordered: ITile[];\n  scooched?: string;\n  smeared?: boolean;\n  goals: IGoal[];\n}\n\ninterface IAppState extends ISharedState, IGameState {\n  loading: string;\n  menuState: IMenuState;\n}\n\nfunction classNames(...classes: Array<string | false | undefined>) {\n  classes = compact(classes);\n  if (classes.length === 0) {\n    return undefined;\n  }\n  return classes.join(\" \");\n}\n\nfunction playerScore(player: IPlayer) {\n  return player.words.map((i) => i.type === \"play\" ? i.points + i.bonusPoints : 0).reduce((a, b) => (a + b), 0);\n}\n\nfunction getTileSet(tileSetName?: string) {\n  return TileSets.find((e) => e.name === tileSetName) || TileSets[0]!\n}\n\nfunction newGame(players?: IPlayer[], tileSetName?: string): IAppState {\n  const board: ITile[] = [];\n  const bag: ITile[] = [];\n  let id = 0;\n  const tileSet = getTileSet(tileSetName);\n  tileSet.tiles.forEach((data) => {\n    for (let j = 0; j < data.count; j++) {\n      bag.push({\n        type: \"letter\",\n        id: `tile-${id++}`,\n        letter: data.letter,\n        points: data.points,\n        drop: 0,\n      })\n    }\n  });\n  for (let j = 0; j < 16; j++) {\n    board.push({\n      type: \"drop\",\n      id: `blank-${j}`,\n    } as ITile)\n  }\n  players = players || [];\n  players.forEach((player) => player.words = []);\n  const options = { ...DEFAULT_OPTIONS, tileSetName: tileSet.name };\n  const gameId = uuid();\n  return { menuState: {}, loading: \"bootstrap\", gameStateVersion: 1, gameId, players, playerIndex: 0, bag, board, original: Array(...board), word: [], reordered: [], nukers: [], passers: [], over: false, options, goals: [], announcements: [] };\n}\n\n// Cache of generated json data URLs\nconst JSON_TO_URL_DATA: { [key: string]: string } = {};\n\nfunction jsonToUrl(key: string, stuff: any) {\n  const data = new Blob([JSON.stringify(stuff)], { type: \"application/json\" });\n\n  // If we are replacing a previously generated file we need to\n  // manually revoke the object URL to avoid memory leaks.\n  if (JSON_TO_URL_DATA[key]) {\n    window.URL.revokeObjectURL(JSON_TO_URL_DATA[key]);\n  }\n\n  JSON_TO_URL_DATA[key] = window.URL.createObjectURL(data);\n\n  // returns a URL you can use as a href\n  return JSON_TO_URL_DATA[key];\n}\n\ninterface IAuth {\n  userId: string;\n  zid: string;\n  password: string;\n  token: string;\n}\n\nconst APP_ID =  5005139;\n\ninterface IQuery {\n  gameId?: string;\n}\n\nfunction getQuery() {\n  return queryString.parse(window.location.search.split(\"?\").pop() || \"\") as IQuery;\n}\n\nexport class App extends React.Component<{}, IAppState> {\n  private automation: IAutomationAction[] = [];\n  private loadGameId?: string;\n  private forcePushGameData?: boolean;\n\n  private batonTimeout?: any;\n  private tickInterval?: any;\n  private pollInterval?: any;\n  private automateInterval?: any;\n  private pushImmediate?: any;\n\n  constructor(props: any) {\n    super(props);\n\n    // This is the local pass-and-play implementation, left here for reference.\n    //\n    // const stateString = sessionStorage.getItem(\"boardState\");\n    // if (stateString) {\n    //   try {\n    //     const state = JSON.parse(stateString) as IAppState;\n    //     App.hydrateAppState(state);\n    //     this.state = state;\n    //     return;\n    //   } catch {\n    //     sessionStorage.clear();\n    //   }\n    // }\n\n    this.loadGameId = sessionStorage.getItem(\"gameId\") || undefined;\n    const menuState = JSON.parse(sessionStorage.getItem(\"menuState\") || \"{}\");\n    this.state = {...newGame(), menuState};\n  }\n\n  public componentDidMount(): void {\n    this.tickInterval = setInterval(this.tick, 100);\n    const query = getQuery();\n    this.loadGameId = query.gameId;\n    this.getToken();\n  }\n\n  private getToken = () => {\n    if (this.auth) {\n      return;\n    }\n    let password = this.deviceIdentifier;\n    let userId = this.authUserId;\n    if (userId === undefined) {\n      this.setState({loading: \"register-device\"}, () =>\n      fetch(\"https://api.zynga.com/auth/registerDevice\",\n          {method: \"POST\", body: JSON.stringify({password, appId: APP_ID}), headers: {\"Content-Type\": \"application/json\"}})\n          .then((response) => response.json())\n          .then((auth: IAuth) => {\n            //console.log({registerDevice: auth});\n            localStorage.setItem(\"DeviceIdentifier\", password);\n            localStorage.setItem(\"AuthUserId\", auth.userId);\n            this.getToken();\n          })\n          .catch(console.error));\n      return;\n     }\n    this.setState({loading: \"authenticating\"}, () =>\n   fetch(\"https://api.zynga.com/auth/issueToken\",\n        {\n          method: \"POST\",\n          body: JSON.stringify({password, userId, appId: APP_ID}),\n          headers: {\"Content-Type\": \"application/json\"}\n        })\n        .then((response) => {\n          if (response.status < 400) {\n            return response.json();\n          } else {\n            console.error(response);\n            throw new Error(response.statusText);\n          }\n        })\n        .then((token) => {\n          if (token) {\n            //console.log({issueToken: token});\n            this.auth = {\n              password, userId, ...token,\n            };\n            this.onAuthenticated();\n          } else {\n            throw new Error(\"no json body\");\n          }\n        })\n        .catch(console.error));\n  }\n\n  private auth?: IAuth;\n\n  private get deviceIdentifier() {\n    return localStorage.getItem(\"DeviceIdentifier\") || uuid();\n  }\n\n  private get authUserId() {\n    return localStorage.getItem(\"AuthUserId\") || undefined;\n  }\n\n  private onAuthenticated = () => {\n    this.pollInterval = setInterval(this.poll, 5000);\n    this.automateInterval = setInterval(this.automate, 1000);\n    const gameId = this.loadGameId;\n    if (gameId) {\n      this.setState({loading: \"joining-game\"}, () =>\n          this.pullGameData(gameId));\n    }\n  };\n\n  private poll = () => {\n    if (!this.auth) {\n      return;\n    }\n    const gameId = this.loadGameId || this.state.gameId;\n    if (gameId) {\n      this.setState({loading: \"loading-game\"}, () =>\n        this.pullGameData(gameId));\n    }\n  }\n\n  private pullGameData(gameId: string) {\n    if (!this.auth) {\n      return;\n    }\n    fetch(\"https://api.zynga.com/conversation/join\",\n        {\n          method: \"POST\",\n          headers: {\"Content-Type\": \"application/json\", \"Authorization\": \"token \" + this.auth.token},\n          body: JSON.stringify({\n            accessType: \"public\",\n            id: gameId,\n          })\n        })\n        .then((response) => response.json())\n        .then((response) => {\n          const {baton, gameStateVersion, boardState} = response.meta;\n          this.batonTimeout = undefined;\n          if (typeof boardState === \"string\" && gameStateVersion > this.state.gameStateVersion) {\n            console.warn(`Pulled Game State: gameStateVersion ${this.state.gameStateVersion} => ${gameStateVersion}`);\n            const state: IAppState = JSON.parse(boardState) as IAppState;\n            const rawState: IAppState = JSON.parse(boardState) as IAppState;\n            App.hydrateAppState(state);\n            //console.log(explainDiff(diff.diff(rawState, state)));\n            this.setState({...state, baton, gameStateVersion, loading: \"ready\"} as any);\n            return;\n          } else {\n            this.setState({loading: \"ready\", baton}, this.ensureParticipant);\n          }\n        })\n        .catch(console.error);\n  }\n\n  /**\n   * Turn a serialized game state into a proper runtime state:\n   *  - ensure multiple serialization of the same object are turned back into references to a single object\n   *  - restore prototypes of objects that aren't pure state\n   *\n   * NB: this mutates {state} in-place\n   */\n  private static hydrateAppState(state: IAppState) {\n    // Restore object identities lost in serialization\n    // Any place where proper {ITile}s appear, we have to make sure they all reference the same object\n    for (let i = 0; i < state.word.length; i++) {\n      state.word[i] = state.board.find((tile) => tile.id === state.word[i].id)!;\n    }\n    for (let i = 0; i < state.reordered.length; i++) {\n      state.reordered[i] = state.board.find((tile) => tile.id === state.reordered[i].id)!;\n    }\n\n    // These were only for backwards-compatibility with state saved in {sessionStorage} but it's\n    // the sort of thing we schould consider doing if we add new required fields and don't want to break\n    // in-progress games.\n    //\n    // if (state.nukers === undefined) {\n    //   state.nukers = [];\n    // }\n    // if (state.passers === undefined) {\n    //   state.passers = [];\n    // }\n    // if (state.options === undefined) {\n    //   state.options = {};\n    // }\n    // if (state.announcements === undefined) {\n    //   state.announcements = [];\n    // }\n    // if (state.gameId === undefined) {\n    //   state.gameId = uuid();\n    // }\n\n    // Goals aren't plain-old-data-objects, so hydrate them\n    state.goals = this.hydrateGoals(state.goals || []);\n  }\n\n  private static hydrateGoals(goals: IGoal[]): IGoal[] {\n    return goals.map( (goal) => {\n        switch (goal.type) {\n          case \"Double Up\":\n            return DoublesGoal.fromJson(goal);\n          case \"Cheapskate\":\n            return CheapskateGoal.fromJson(goal);\n          case \"Get Moving\":\n            return VerbGoal.fromJson(goal);\n          case \"Over It\":\n            return VerbPastGoal.fromJson(goal);\n          case \"Shortie\":\n            return LengthGoal.fromJson(goal);\n          case \"Up Front\":\n            return StartsWithGoal.fromJson(goal);\n          default:\n            throw new Error(`Unknown goal type: ${goal.type}`);\n        }\n      });\n  }\n\n  private get myPlayer() {\n    if (!this.state.players) {\n      return undefined;\n    }\n    return this.state.players.find((p) => p.userId === this.myUserId);\n  }\n\n// private static finderUrl(gameId: string, gameStateVersion: number) {\n  // `  return `https://api.zynga.com/finder/app/${APP_ID}/index/${GAME_INDEX}/id/${gameId}?gameStateVersion=${gameStateVersion}`;\n  // }\n\n  private lastSavedState?: string;\n\n  private get itIsMyTurn() {\n    const myUserId = this.myUserId;\n    if (!myUserId) {\n      return false;\n    }\n    const currentPlayerUserId = this.currentPlayer.userId;\n    const isMyTurn = currentPlayerUserId === myUserId;\n    return isMyTurn;\n  }\n\n  private get currentPlayer() {\n    return this.state.players[this.state.playerIndex];\n  }\n\n  private get myUserId() {\n    if (!this.auth) {\n      return undefined;\n    }\n    return this.auth.zid;\n  }\n\n  public componentDidUpdate(prevProps: any, prevState: any) {\n    //console.log({componentDidUpdate: explainDiff(diff.diff(prevState, this.state))});\n    if (this.myPlayer && localStorage.getItem(PLAYER_NAME_KEY) !== this.myPlayer.name) {\n      localStorage.setItem(PLAYER_NAME_KEY, this.myPlayer.name);\n    }\n    if (!this.auth) {\n      return;\n    }\n    this.ensureParticipant();\n    if (this.state.reordered.length > 0 && (this.state.board.find((e, i) => this.state.original[i] !== e) === undefined)) {\n      this.setState({ reordered: [], scooched: undefined });\n    } else {\n      if (this.pushImmediate) {\n        clearTimeout(this.pushImmediate);\n      }\n      this.pushImmediate = setTimeout(this.push, 10);\n    }\n    if (this.state.baton) {\n      if (!this.batonTimeout) {\n        this.batonTimeout = setTimeout(() => this.setState((state) => {\n          this.batonTimeout = undefined;\n          if (state.baton && state.baton.timeout < Date.now()) {\n            return {baton: undefined};\n          }\n          return {};\n        }), this.state.baton.timeout - Date.now());\n      }\n    }\n    // Ensure that all participants have the same URL in their window so reloading doesn't start a new game:\n    if (this.state.options.solo !== undefined) {\n      if (window.location.href !== this.gameUrl) {\n        if (window.history.pushState) {\n          window.history.pushState({path: this.gameUrl}, '', this.gameUrl);\n        }\n      }\n    }\n    sessionStorage.setItem(\"menuState\", JSON.stringify(this.state.menuState));\n  }\n\n  private push = () => {\n    if (!this.auth) { return; }\n    const token = this.auth.token;\n    const updateProhibited = this.gameStateLocked;\n    const newBaton = {\n      userId: this.myUserId!,\n      timeout: Date.now() + 1000,\n    };\n    const boardStateSource = this.stateToJson(this.state);\n    const boardState = JSON.stringify(boardStateSource);\n    let needsPush = false;\n    if (this.lastSavedState) {\n      const stateDiff = diff.diff(JSON.parse(this.lastSavedState), JSON.parse(boardState));\n      //console.log({pushDiff: explainDiff(stateDiff)});\n      needsPush = !!stateDiff;\n    } else {\n      needsPush = true;\n    }\n    if (needsPush) {\n      //console.log(\"push!\");\n      if (!updateProhibited) {\n        this.forcePushGameData = false;\n        this.lastSavedState = boardState;\n        const {gameId} = this.state;\n        const gameStateVersion = this.state.gameStateVersion + 1;\n        fetch(\"https://api.zynga.com/conversation/join\",\n            {\n              method: \"POST\",\n              headers: {\"Content-Type\": \"application/json\", \"Authorization\": \"token \" + token},\n              body: JSON.stringify({\n                accessType: \"public\",\n                id: gameId,\n              })\n            })\n            .then((response) => response.json())\n            .then((response) => {\n              //console.log({join: response});\n              sessionStorage.setItem(\"gameId\", response.id);\n              // TODO: check our gameStateVersion against the one in the current meta to make sure we're not rewinding time.\n              return fetch(\"https://api.zynga.com/conversation/editConversationMeta\",\n                  {\n                    method: \"POST\",\n                    headers: {\"Content-Type\": \"application/json\", \"Authorization\": \"token \" + token},\n                    body: JSON.stringify({\n                      accessType: \"public\",\n                      id: gameId,\n                      meta: {baton: newBaton, gameStateVersion, boardState},\n                    })\n                  });\n            })\n            .then((response) => response.json())\n            .then((response) => {\n              //console.log({update: response});\n              this.batonTimeout = undefined;\n              this.setState({baton: newBaton, gameStateVersion});\n            })\n            .catch(console.error);\n      } else {\n        console.warn({\n          stateChangesWhileNotMyTurn: {\n            ...this.state,\n            loading: \"saved\", baton: undefined,\n            auth: undefined, gameStateVersion: undefined\n          }, lastSavedState: this.lastSavedState && JSON.parse(this.lastSavedState)\n        });\n      }\n    }\n  }\n\n  private stateToJson(baseState: IAppState) {\n    return omit(baseState, \"loading\", \"menuState\", \"baton\", \"auth\", \"gameStateVersion\");\n  }\n\n  componentWillUnmount(): void {\n    if (this.batonTimeout) {\n      clearTimeout(this.batonTimeout)\n    }\n    if (this.tickInterval) {\n      clearInterval(this.tickInterval)\n    }\n    if (this.pollInterval) {\n      clearInterval(this.pollInterval)\n    }\n    if (this.automateInterval) {\n      clearInterval(this.automateInterval)\n    }\n  }\n\n  private get gameStateLocked() {\n    return this.state.baton && this.state.baton.userId !== this.myUserId && this.state.baton.timeout > Date.now();\n  }\n\n  private ensureParticipant() {\n    const myPlayer = this.myPlayer;\n    if (myPlayer === undefined) {\n      let players = this.state.players;\n      const unassignedPlayer = players.find((e) => e.userId === undefined);\n      if (unassignedPlayer) {\n        unassignedPlayer.userId = this.myUserId;\n      } else {\n        players.push({name: localStorage.getItem(PLAYER_NAME_KEY) || DEFAULT_PLAYER_NAME, words: []});\n        this.forcePushGameData = true;\n      }\n      this.setState({players});\n    }\n  }\n\n  public render() {\n    if (this.myPlayer === undefined) {\n      return <Alert><Alert.Heading>Loading</Alert.Heading><p>{this.state.loading}</p></Alert>;\n    }\n    const tileSet = getTileSet(this.state.options.tileSetName);\n    // const totalTiles = tileSet.tiles.map((tile) => tile.count).reduce((a, b) => a + b);\n    // const totalPoints = tileSet.tiles.map((tile) => tile.count * tile.points).reduce((a, b) => a + b);\n    let selectableLetters = Array(...this.state.board);\n    if (this.state.word.length > 0) {\n      selectableLetters = selectableLetters.filter((tile, index) => this.canSelect(index));\n    }\n    let canPlay = false;\n    let playLabel = \"Too Short\";\n    if (this.state.word.length > 2) {\n      canPlay = isWord(this.state.word);\n      const word = this.state.word.map((tile) => tile.letter).join(\"\");\n      let points = this.state.word.map(this.tilePoints).reduce((a, b) => (a || 0) + (b || 0));\n      let bonusPoints = this.state.word.map(this.bonusPoints).reduce((a, b) => (a || 0) + (b || 0)) || 0;\n      bonusPoints = bonusPoints + this.state.goals.map((goal) => goal.check(this.pendingMove) ? goal.points : 0).reduce((a, b) => a + b, 0);\n      points = (points || 0) + bonusPoints;\n      if (canPlay) {\n        if (this.state.smeared) {\n          playLabel = `Release to play '${word}' for ${points || \"no\"} points`;\n        } else {\n          playLabel = `Play '${word}' for ${points || \"no\"} points`;\n        }\n      } else {\n        playLabel = `'${word}' is not a word`;\n      }\n    }\n \n    // If the player was smearing, auto-play if possible. \n    // If the player was tapping letters or scooching, though, don't do anything.\n    let onDone: ((key: string) => void) | undefined;\n    if (this.state.smeared) {\n      if (canPlay) {\n        onDone = this.onPlay;\n      } else {\n        onDone = (id) => {\n          // TODO: this should probably be an option\n          // deselect everything if the smear ends on a selected tile and the word's invalid,\n          // otherwise leave state unchanged (as in the end of a scooch)\n          const i = this.state.word.findIndex((tile) => tile.id === id);\n          //console.log({ id, word: this.state.word, i });\n          if (i >= 0) {\n            this.setState({ word: [] });\n          }\n        };\n      }\n    } else {\n      onDone = undefined;\n    }\n\n    const scoredPlayers = this.state.players.map((player) => {\n      const score = playerScore(player);\n      return { score, ...player };\n    }).sort((a, b) => b.score - a.score);\n    let overHeader = <Alert.Heading>{scoredPlayers[0].name} Wins!</Alert.Heading>;\n    if (scoredPlayers.find((e) => e.score !== scoredPlayers[0].score) === undefined) {\n      overHeader = <Alert.Heading>It’s a tie!</Alert.Heading>;\n    }\n\n    const yourPoints = this.state.players[0].words.map((play) => play.type === \"play\" ? play.points + play.bonusPoints : 0).reduce((a, b) => a + b, 0);\n    //const yourTiles = this.state.players[0].words.map((play) => play.type === \"play\" ? play.word.length : 0).reduce((a, b) => a + b, 0);\n    //const targetPoints = (yourTiles / totalTiles) * totalPoints;\n    const yourTargetPoints = this.state.players[0].words\n      .map((play) => play.type === \"play\" ? play.word : [])\n      .reduce((a, b) => a.concat(b), [])\n      .map((playedTile) => playedTile.letter)\n      .map((letter) => tileSet.tiles.find((e) => e.letter === letter)!.points)\n      .reduce((a, b) => a + b, 0) + this.state.players[0].words.length;\n    const stars = yourPoints - yourTargetPoints;\n    let starsString = \"\";\n    for (let i = 0; i < Math.abs(stars); ++i) {\n      starsString += \"★\";\n    }\n\n    const gameUrl = this.gameUrl;\n    return <Container fluid={true}>\n      {this.renderModal()}\n      <Row>\n        <Col className={compact([\"col-sm-12\", \"col-xl-6\", \"board-col\", this.state.over && \"over\"]).join(\" \")}>\n          <Row className=\"board-footer\">\n            <Col sm={4} className=\"sm-right\">\n              {this.state.players.length > 1\n                  ? <>\n                    {this.itIsMyTurn ? <b>Your Turn</b> : `${this.state.players[this.state.playerIndex].name}’s Turn`}\n                  </>\n                  : <>\n                    {gameUrl && this.state.players && this.state.players.length < 2 &&\n                    <Button variant={this.state.options.solo ? \"outline-primary\" : \"primary\"}\n                            onClick={() => this.changeOptions(() => ({solo: undefined}))}>Invite a Friend</Button>}\n                    {/* Solo Mode: {stars > 0 && \"+\"}{stars} */}\n                    <span className={`stars ${stars >= 0 ? \"positive\" : \"negative\"}`}>{starsString}</span>\n                    {/* Solo Mode: {yourPoints} / {yourTargetPoints} */}\n                  </>}\n            </Col>\n            <Col sm={4}>\n              <ButtonGroup>\n                <Button variant=\"success\"\n                        title={\"Open the Main Menu.\"}\n                        onClick={this.showMenu}>Menu</Button>\n              </ButtonGroup>\n            </Col>\n            <Col sm={4} className=\"sm-left\">\n              {this.state.bag.length} tiles left\n            </Col>\n          </Row>\n          <Row>\n            <div className=\"play-area\">\n              <Row><Button\n                  className={classNames(\"play-button\", canPlay && \"can-play\")}\n                  variant={canPlay ? \"primary\" : \"outline-primary\"}\n                  disabled={!canPlay}\n                  onClick={this.onPlay}\n              >{playLabel}</Button>\n              </Row>\n              {this.state.word.map((item, index) => (\n                  <div key={index} className=\"tile\">\n                    <div className=\"field\" style={{backgroundImage:`url(${tile})`, backgroundSize: 'contain', backgroundRepeat: 'no-repeat'}}>\n                      <div className=\"points\">{this.tilePoints(item) || <>&nbsp;</>}</div>\n                      <div className=\"letter\">{item.letter}</div>\n                      {this.bonusPoints(item) && <div className=\"bonus\">+{this.bonusPoints(item)}</div>}\n                    </div>\n                  </div>\n              ))}\n              {/* <div style={{marginTop: \"1rem\", textAlign: \"center\", border: \"1px solid black\"}}>★★★★★</div> */}\n              {this.state.word.length === 0 && <div className=\"tile space\"/>}\n              <div className=\"container\">\n                <div className=\"flex-grow\"/>\n              </div>\n            </div>\n          </Row>\n          <Row className=\"untouchable\">\n            {this.state.over &&\n            <div className=\"overlay\">\n              <Alert variant=\"success\" width=\"100%\">\n                {overHeader}\n                Final Score: {\n                scoredPlayers.map((player) => `${player.name}: ${player.score}`).join(\", \")\n              }\n              </Alert>\n            </div>}\n            {!this.itIsMyTurn &&\n            <div className=\"overlay\">\n              <Alert variant=\"info\" width=\"100%\">\n                <Alert.Heading>It’s {this.currentPlayer.name}’s Turn</Alert.Heading>\n                {this.gameStateLocked && <>Game state locked\n                  for {humanizeDuration(this.state.baton!.timeout - Date.now())}</>}\n              </Alert>\n            </div>}\n            {this.state.announcements &&\n            <div className=\"overlay\">\n              {this.state.announcements.map((a) =>\n                  <div key={a.key} className=\"announcement\"\n                       onAnimationEnd={() => this.setState((state) => ({announcements: without(state.announcements, a)}))}>\n                    <div className=\"title\">{a.title}</div>\n                    <div className=\"message\">{a.message}</div>\n                  </div>)}\n            </div>}\n            <SlideGrid\n                className=\"board\"\n                canExchange={this.canScooch}\n                tap={this.onClickItem}\n                done={onDone}\n                smear={this.onSmear}\n                exchange={this.onExchange}\n            >\n              {\n                this.state.board.map((item, index) => {\n                  const classes = [\"tile\"];\n                  if (this.state.word.includes(item)) {\n                    classes.push(\"selected\");\n                  }\n                  if (selectableLetters.indexOf(item) >= 0) {\n                    classes.push(\"selectable\");\n                  } else {\n                    classes.push(\"unselectable\");\n                  }\n                  if (this.canScooch(item.id)) {\n                    classes.push(\"swappable\");\n                  } else {\n                    classes.push(\"unswappable\");\n                  }\n                  if (item.type === \"space\") {\n                    classes.push(\"space\");\n                  }\n                  if (this.reordered(item)) {\n                    classes.push(\"reordered\");\n                  }\n                  if (this.state.options.oneScoochPerTurn && this.state.scooched === item.id) {\n                    classes.push(\"scooched\");\n                  }\n                  if ((index % 4) === 0) {\n                    classes.push(\"start-row\");\n                  }\n                  if (item.drop) {\n                    classes.push(`drop-${item.drop}`);\n                  }\n                  const id = item.id;\n                  return (\n                      <div className={classes.join(\" \")} key={id} id={id}>\n                        <div className=\"field\" style={{\n                          backgroundImage: `url(${tile})`,\n                          backgroundSize: 'contain',\n                          backgroundRepeat: 'no-repeat'\n                        }}>\n                          <div className=\"points\">{this.tilePoints(item) || <>&nbsp;</>}</div>\n                          <div className=\"letter\">{item.letter || <>&nbsp;</>}</div>\n                        </div>\n                      </div>\n                  );\n                })\n              }\n            </SlideGrid>\n          </Row>\n\n          <Row>\n            <Card>\n              <Card.Header>\n                Goals\n              </Card.Header>\n              <Card.Body>\n                {this.state.goals.map((goal, index) => {\n                  const move = this.pendingMove;\n                  const possible = goal.possible(this.state.board);\n                  // TODO: doesn't take into account scooched tile's lost points?\n                  const thisMoveQualifies = canPlay && goal.check(move);\n                  const classNames = [\n                    \"goal\",\n                    thisMoveQualifies && \"qualifies\",\n                    possible && \"possible\",\n                  ];\n                  return <Row key={index} className={compact(classNames).join(\" \")}>\n                    <Col md={10}>\n                      <Badge variant=\"warning\">{goal.type}</Badge><br/>\n                      {goal.description}\n                    </Col>\n                    <Col md={2}>\n                      <Badge variant=\"success\" pill={true}>+{goal.points}</Badge>\n                    </Col>\n                  </Row>\n                })}\n              </Card.Body>\n            </Card>\n          </Row>\n        </Col>\n        <Col>\n          <Row className=\"players\">\n            {this.state.players.map((player, playerIndex) => {\n              const isCurrentPlayer = this.state.playerIndex === playerIndex;\n              return <Col key={`player-${playerIndex}`} md={6}\n                          className={compact([\"player\", isCurrentPlayer && \"current\"]).join(\" \")}>\n                <Row className=\"header\">\n                  <Col md={7} className=\"name\">\n                    <input type=\"text\" value={player.name} onChange={(event) => {\n                      player.name = event.target.value;\n                      this.setState((state) => {\n                        const players = Array(...state.players);\n                        return {players};\n                      });\n                    }}/>\n                  </Col>\n                  <Col md={2} className=\"score\">{playerScore(player)}</Col>\n                  <Col md={1}>{isCurrentPlayer && <div className=\"turn-indicator\"/>}</Col>\n                </Row>\n                <div>\n                  <Form.Check type=\"checkbox\" label=\"Automated\" checked={!!player.automated} onChange={(event: any) => {\n                    player.automated = event.target.checked;\n                    this.setState((state) => {\n                      const players = Array(...state.players);\n                      return {players};\n                    });\n                  }}/>\n                </div>\n                <div>\n                  {player.userId}\n                </div>\n                <div className=\"moves\">\n                  {player.words.map((play, index) => {\n                    let wordContent: any = <Badge pill={true} variant={MOVE_VARIANTS[play.type]}>{play.type}</Badge>;\n                    if (play.type === \"play\") {\n                      wordContent = <>{play.word.map((tile) => <div key={tile.id} className=\"tile\">\n                        <div className=\"field\" style={{backgroundImage:`url(${tile})`, backgroundSize: 'contain', backgroundRepeat: 'no-repeat'}}>\n                          <div className=\"points\">{tile.points || <>&nbsp;</>}</div>\n                          <div className=\"letter\">{tile.letter}</div>\n                        </div>\n                      </div>)}\n                        {play.goals.map((goal) => <div className=\"bonus\">{goal.type}</div>)}\n                        {play.bonusPoints ? <div className=\"bonus\">+{play.bonusPoints}</div> : \"\"}\n                      </>;\n                    }\n                    return <Row key={index}><Col md={8}>{wordContent}</Col>\n                      <Col md={1}\n                           className=\"score\">{play.type === \"play\" && (play.points + play.bonusPoints)}</Col></Row>\n                  })}\n                </div>\n              </Col>\n            })}\n          </Row>\n\n          <Container className=\"mt-2\">\n            <ButtonGroup>\n              <Button variant=\"secondary\" onClick={() => this.setState((state) => {\n                const players = Array(...state.players);\n                players.pop();\n                return {players};\n              })}>-</Button>\n              <Button variant=\"outline-secondary\" disabled={true}>Players</Button>\n              <Button variant=\"secondary\" onClick={() => this.setState((state) => {\n                const players = Array(...state.players);\n                players.push({\n                  name: `Player ${players.length + 1}`,\n                  words: [],\n                });\n                return {players};\n              })}>+</Button>\n            </ButtonGroup>\n            <div className=\"flex-fill\"/>\n            <ButtonGroup>\n              <Button variant=\"outline-success\" onClick={() => {\n                const url = jsonToUrl(\"game.json\", this.state);\n                window.open(url, \"_blank\");\n              }}>Save Game</Button>\n              <Button variant=\"outline-danger\"\n                      onClick={() => this.setState(newGame(undefined, this.state.options.tileSetName))}>New\n                Game</Button>\n              <Button variant=\"outline-danger\"\n                      onClick={() => this.setState(newGame(this.state.players, this.state.options.tileSetName))}>with\n                Same Players</Button>\n            </ButtonGroup>\n          </Container>\n\n          <Row>\n            <Col>\n              <hr/>\n            </Col>\n          </Row>\n\n          <RulesComponent tileSet={this.tileSet} bag={this.state.bag} options={this.state.options}\n                          changeOptions={this.changeOptions} resetOptions={this.resetOptions}/>\n\n          <Row>\n            <Col>\n              <hr/>\n            </Col>\n          </Row>\n\n          <Row>\n            <Col>\n              <dl>\n                <dt>Status</dt>\n                <dd>{this.state.loading}</dd>\n                <dt>Game Data gameStateVersion</dt>\n                <dd>{`${this.state.gameStateVersion}`}</dd>\n              </dl>\n            </Col>\n          </Row>\n\n        </Col>\n      </Row>\n    </Container>;\n  }\n\n  private renderModal() {\n    const {menuState, options, players} = this.state;\n    const {gameUrl, myPlayer} = this;\n    const qrDialog = players && players.length < 2 && options.solo === undefined;\n    if (qrDialog && gameUrl && myPlayer) {\n      return this.renderQrDialog(gameUrl, myPlayer);\n    }\n    //console.log({menuState});\n    const mainMenu = menuState.open;\n    if (mainMenu) {\n      return this.renderMainMenu();\n    }\n    return false;\n  }\n\n  private renderQrDialog(gameUrl: string, player: IPlayer) {\n    return <InviteComponent\n        gameUrl={gameUrl} playerName={player.name}\n        changePlayerName={(value) => {\n          player.name = value;\n          this.setState((state) => {\n            const players = Array(...state.players);\n            return {players};\n          });\n        }}\n        dismiss={() => this.changeOptions(() => ({solo: true}))}\n        play={() => this.changeOptions(() => ({solo: false}))}\n    />;\n  }\n\n  private renderMainMenu() {\n    const passWillResign = this.state.passers.includes(this.state.playerIndex);\n\n    return <MainMenuComponent\n        show={!!this.state.menuState.open} hide={this.hideMenu}\n\n        canPass={!this.state.over}\n        passWillEndGame={passWillResign}\n        pass={this.onPass}\n\n        canReset={this.state.reordered.length !== 0 || this.state.word.length !== 0}\n        reset={this.onReset}\n\n        {...this.canNuke()}\n        nuke={this.onNuke}\n    />;\n  }\n\n  private get gameUrl() {\n    if (this.state.gameId === undefined) {\n      return undefined;\n    }\n    return `${window.location.toString().split(\"?\").shift()}?gameId=${this.state.gameId}`;\n  }\n\n  private get pendingMove(): IPlay {\n    return {\n      type: \"play\",\n      word: this.state.word.map((tile) => ({...tile, points: this.state.reordered.includes(tile) ? 0 : tile.points})),\n      points: 0,\n      bonusPoints: 0,\n      goals: []\n    };\n  }\n\n  private onExchange = (a: string, b: string) => {\n    this.setState((state) => {\n      const aIndex = state.board.findIndex((e) => e.id === a);\n      const bIndex = state.board.findIndex((e) => e.id === b);\n      const board: ITile[] = [];\n      const reordered: ITile[] = Array(...state.reordered);\n      state.board.forEach((tile, index) => {\n        let newIndex = index;\n        if (index === aIndex) {\n          newIndex = bIndex;\n        }\n        else if (index === bIndex) {\n          newIndex = aIndex;\n        }\n        if (newIndex !== index && !reordered.includes(tile)) {\n          reordered.push(tile);\n        }\n        board[newIndex] = tile;\n      });\n      return { board, reordered, scooched: a };\n    });\n  }\n\n  private canNuke() {\n    const usedNuke = this.state.nukers.includes(this.state.playerIndex);\n    const noMoreTiles = this.state.bag.length === 0;\n    const canNuke = !usedNuke && !noMoreTiles;\n    return { usedNuke, noMoreTiles, canNuke };\n  }\n\n  private get tileSet() {\n    return getTileSet(this.state.options.tileSetName);\n  }\n\n  private changeOptions = (change: (options: IScoochOptions) => IScoochOptions) => {\n    this.setState((state) => ({options: change(state.options)}));\n  }\n\n  private resetOptions = () => {\n    this.setState({options: DEFAULT_OPTIONS});\n  }\n\n  private canSelect = (index: number) => {\n    if (this.state.word.length === 0) {\n      return true;\n    }\n    const seedTile = this.state.word[this.state.word.length - 1];\n    const seed = this.state.board.findIndex((tile) => tile === seedTile);\n    const indexRow = Math.floor(index / 4);\n    const seedRow = Math.floor(seed / 4);\n    if (indexRow === seedRow) {\n      return Math.abs(index - seed) === 1;\n    } else {\n      if (Math.abs(indexRow - seedRow) === 1) {\n        return Math.abs(index % 4 - seed % 4) <= 1;\n      }\n      return false;\n    }\n  }\n\n  private getTile(key: string) {\n    return this.state.board.find((e) => e.id === key);// || this.state.bag.find((e) => e.id === key);\n  }\n\n  private getIndex(key: string) {\n    return this.state.board.findIndex((e) => e.id === key);// || this.state.bag.find((e) => e.id === key);\n  }\n\n  private canScooch = (keyA: string, keyB?: string) => {\n    if (this.state.options.oneScoochPerTurn && this.state.scooched && ![keyA, keyB].includes(this.state.scooched)) {\n      return false;\n    }\n    const a = this.getIndex(keyA);\n    if (a < 0 || this.state.word.indexOf(this.state.board[a]) >= 0) {\n      return false;\n    }\n    if (this.state.board[a].type !== \"letter\") {\n      return false;\n    }\n    if (!keyB) {\n      return true;\n    }\n    const b = this.getIndex(keyB);\n    if (b < 0 || this.state.word.indexOf(this.state.board[b]) >= 0) {\n      return false;\n    }\n    if (this.state.board[b].type !== \"letter\") {\n      return false;\n    }\n    const indexRow = Math.floor(b / 4);\n    const seedRow = Math.floor(a / 4);\n    if (indexRow === seedRow) {\n      return Math.abs(b - a) === 1;\n    } else {\n      if (Math.abs(indexRow - seedRow) === 1) {\n        return b % 4 === a % 4;\n      }\n      return false;\n    }\n  }\n\n  private tick = () => {\n    if (this.myPlayer === undefined) { return; }\n    for (let i = this.state.board.length - 1; i >= 0; i--) {\n      const space = this.state.board[i];\n      if (space.type === \"drop\") {\n        this.setState((state) => {\n          const board = Array(...state.board);\n          const bag = Array(...state.bag);\n          i = board.indexOf(space);\n          if (i >= 0) {\n            if (state.bag.length > 0) {\n              const j = Math.floor(Math.random() * state.bag.length);\n              board[i] = bag.splice(j, 1)[0];\n              this.drop(board[i], space.drop);\n            } else {\n              board[i].type = \"space\";\n            }\n          }\n          return { bag, board, original: Array(...board) };\n        });\n        break;\n      }\n    }\n    if (this.pendingDrops.length === 0 && this.clearDrops.length > 0) {\n      while (this.clearDrops.length > 0) {\n        this.clearDrops.pop()!.drop = 0;\n      }\n      console.warn(\"tickForceUpdate\");\n      this.forceUpdate();\n      return;\n    }\n  }\n\n  private automate = () => {\n    if (this.myPlayer === undefined) { return; }\n    const { goals } = this.state;\n    if (goals.length < 3) {\n      const availableLetters = compact([...this.state.bag.map((e) => e.letter), ...this.state.board.map((e) => e.letter)]);\n      switch (Math.floor(Math.random() * 6)) {\n        case 0:\n          goals.push(new CheapskateGoal());\n          break;\n        case 1:\n          goals.push(new VerbGoal());\n          break;\n        case 2:\n          goals.push(new VerbPastGoal());\n          break;\n        case 3:\n          goals.push(new DoublesGoal(sample(\"RSTLNE\")!));\n          break;\n        case 4:\n          if (availableLetters.length > 0) {\n            goals.push(new StartsWithGoal(sample(availableLetters)!));\n          }\n          break;\n        case 5:\n          goals.push(new LengthGoal(sample([3, 4])!));\n          break;\n      }\n      this.setState({ goals: uniqBy(goals, JSON.stringify) });\n      return;\n    }\n\n    const automation = this.automation.shift();\n    if (automation) {\n      switch (automation.type) {\n        case \"tap\":\n          this.onClickItem(automation.a, false);\n          return;\n        case \"wait\":\n          return;\n        case \"nuke\":\n          this.onNuke();\n          return;\n        case \"pass\":\n          this.onPass();\n          return;\n        case \"submit\":\n          this.onPlay();\n          return;\n        default:\n          console.error({ automation });\n          return;\n      }\n    }\n\n    const {board, players, playerIndex} = this.state;\n    const { canNuke } = this.canNuke();\n    const currentPlayer = players[playerIndex];\n    if (currentPlayer.automated) {\n      if (!board.some((t)=>t.type === \"drop\")) {\n        const possibilities: Array<[number, ITile[]]> = [];\n        new WordFinder(board, 4, (word) => {\n          if (word.length >= 3) {\n            const points: number = word.map((e) => e.points).reduce((a, b) => a + b, 0);\n            possibilities.push([points, word]);\n          }\n        }).findWords();\n        possibilities.sort((a, b) => a[0] - b[0]);\n        const play = possibilities.pop();\n        //console.log({possibilities});\n        if (play !== undefined) {\n          this.automation = play[1].map((e) => ({\n            type: \"tap\",\n            a: e.id,\n          }));\n          this.automation.push({type: \"wait\"});\n          this.automation.push({type: \"submit\"})\n        } else if (canNuke) {\n          this.automation.push({type: \"nuke\"});\n        } else {\n          this.automation.push({type: \"pass\"});\n        }\n      }\n    }\n  }\n\n  private reordered = (tile: ITile) => {\n    return this.state.reordered.includes(tile);\n  }\n\n  private tilePoints = (tile: ITile): number | undefined => {\n    if (this.reordered(tile)) {\n      return undefined;\n    }\n    return tile.points;\n  }\n\n  private bonusPoints = (tile: ITile): number | undefined => {\n    if (!this.state.options.bonusForLongerWords) {\n      return undefined;\n    }\n    const index = this.state.word.indexOf(tile);\n    if (this.state.options.bonusForLongerWords === \"constant\") {\n      if (index < 4) {\n        return undefined;\n      }\n      return 1;\n    }\n    if (index < 3) {\n      return undefined;\n    }\n    return index - 2;\n  }\n\n  private tileSelected = (tile: ITile, word?: ITile[]) => {\n    if (word === undefined) {\n      word = this.state.word;\n    }\n    return word.includes(tile);\n  }\n\n  private onSmear = (key: string) => {\n    const id = key;\n    const tile = this.state.board.find((tile) => tile.id.toString() === id);\n    if (tile) {\n      const index = this.state.board.indexOf(tile);\n      if (!this.tileSelected(tile)) {\n        if (this.canSelect(index)) {\n          this.onClickItem(key, true);\n        }\n      } else {\n        const preserveIndex = this.state.word.indexOf(tile);\n        const tileToDeselect = this.state.word[preserveIndex + 1];\n        if (tileToDeselect) {\n          this.onClickItem(tileToDeselect.id, true);\n        }\n      }\n    }\n  }\n  \n  private onClickItem = (key: string, smeared: boolean = false) => {\n    const id = key;\n    const tile = this.state.board.find((tile) => tile.id.toString() === id);\n    if (tile) {\n      const index = this.state.board.indexOf(tile);\n      if (this.tileSelected(tile) || this.canSelect(index)) {\n        this.setState((state) => {\n          const word = Array(...state.word);\n          if (this.tileSelected(tile, word)) {\n            while (this.tileSelected(tile, word)) {\n              word.pop();\n            }\n          } else {\n            word.push(tile);\n          }\n          return { word, smeared };\n        });\n      }\n    }\n  }\n\n  private showMenu = () => {\n    this.setState((state) => ({menuState: {...state.menuState, open: true}}));\n  }\n\n  private hideMenu = () => {\n    this.setState((state) => ({menuState: {...state.menuState, open: false}}));\n  }\n\n  private onReset = () => {\n    this.setState((state) => {\n      return { word: [], board: state.original, reordered: [], scooched: undefined };\n    });\n  }\n\n  private onNuke = () => {\n    this.setState((state) => {\n      const board: ITile[] = [];\n      for (let j = 0; j < 16; j++) {\n        board.push({\n          type: \"drop\",\n          id: `blank-${j}`,\n        } as ITile)\n      }\n      const bag: ITile[] = Array(...state.bag);\n      state.board.forEach((tile) => {\n        if (tile.type === \"letter\") {\n          bag.push(tile);\n        }\n      });\n      const playerIndex = state.playerIndex;\n      const nukers = Array(...state.nukers);\n      nukers.push(playerIndex);\n      const players = Array(...state.players);\n      players[playerIndex].words.push({ type: \"nuke\" });\n      return { nukers, bag, board, scooched: undefined };\n    })\n  }\n\n  private onPass = () => {\n    this.setState((state) => {\n      let playerIndex = state.playerIndex;\n      const passers = Array(...state.passers);\n      if (passers.includes(playerIndex)) {\n        return { ...state, word: [], board: state.original, reordered: [], over: true };\n      } else {\n        passers.push(playerIndex);\n        const players = Array(...state.players);\n        players[playerIndex].words.push({ type: \"pass\" });\n        playerIndex = (playerIndex + 1) % state.players.length;\n        return { ...state, word: [], board: state.original, reordered: [], playerIndex, passers, scooched: undefined };\n      }\n    });\n  }\n\n  private onPlay = () => {\n    this.setState((state) => {\n      const board = Array(...state.board);\n      const word = Array(...state.word);\n      const playedWord: IPlayedTile[] = [];\n      let points = 0;\n      let bonusPoints = 0;\n      while (word.length > 0) {\n        const tile = word.pop()!;\n        const letter = tile.letter;\n        const tilePoints = this.tilePoints(tile);\n        const tileBonusPoints = this.bonusPoints(tile);\n        playedWord.unshift({ id: tile.id, letter, points: tilePoints, bonusPoints: tileBonusPoints });\n        points += (tilePoints || 0);\n        bonusPoints += (tileBonusPoints || 0);\n        let seed = board.indexOf(tile);\n        const drops: ITile[] = [];\n        while (seed >= 0) {\n          const drop = seed - 4;\n          if (drop >= 0) {\n            board[seed] = board[drop];\n            board[seed].drop++;\n          } else {\n            board[seed] = { type: \"drop\", id: `dropping-${tile.id}`, drop: board[seed].drop + 1 } as ITile;\n          }\n          drops.push(board[seed]);\n          seed = drop;\n        }\n        drops.forEach((tile) => this.drop(tile, tile.drop));\n      }\n      const players = Array(...state.players);\n      const player = players[state.playerIndex];\n      const playMove: IPlay = {\n        type: \"play\",\n        word: playedWord,\n        points,\n        bonusPoints,\n        goals: [],\n      };\n      player.words.push(playMove);\n      this.state.goals.forEach((goal) => {\n        if (goal.check(playMove)) {\n          this.announceGoal(goal);\n          playMove.goals.push(goal);\n          playMove.bonusPoints += goal.points;\n        }\n      });\n      const goals = without(this.state.goals, ...playMove.goals);\n      const playerIndex = (state.playerIndex + 1) % players.length;\n      return { board, word, players, playerIndex, original: Array(...board), reordered: [], passers: [], scooched: undefined, goals };\n    })\n  }\n\n  private pendingDrops: ITile[] = [];\n  private clearDrops: ITile[] = [];\n\n  private announceGoal(goal: IGoal) {\n    this.announce(`${goal.type} +${goal.points}`, goal.description);\n  }\n\n  private drop(tile: ITile, distance: number) {\n    this.pendingDrops.push(tile);\n    tile.drop = distance;\n    setTimeout(() => {\n      const i = this.pendingDrops.indexOf(tile);\n      this.pendingDrops.splice(i, 1)\n      this.clearDrops.push(tile);\n    }, tile.drop * 1000);\n  }\n\n  private announce(title: string, message: string) {\n    this.setState((state) => {\n      const {announcements} = state;\n      announcements.push({title, message, key: ++UID});\n      return {announcements};\n    })\n  }\n}\n\nexport default App;\n","import Modal from \"react-bootstrap/Modal\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Figure from \"react-bootstrap/Figure\";\nimport QRCode from \"qrcode.react\";\nimport Form from \"react-bootstrap/Form\";\nimport Button from \"react-bootstrap/Button\";\nimport React from \"react\";\nimport \"InviteComponent.css\";\nimport {phone} from \"./Globals\";\nimport {DEFAULT_PLAYER_NAME} from \"./App\";\n\ninterface IInviteComponentProps {\n    gameUrl: string;\n    playerName: string;\n\n    changePlayerName(value: string): void;\n\n    play(): void;\n\n    dismiss(): void;\n}\n\nexport default class InviteComponent extends React.Component<IInviteComponentProps> {\n    public render() {\n        const {gameUrl, playerName, changePlayerName, play, dismiss} = this.props;\n        return <Modal className={\"invite\"} backdrop={\"static\"} show={true} onHide={dismiss} scrollable={false}>\n            {\n                phone()\n                    ? <div className={\"top-spacer\"}/>\n                    : <Modal.Header closeButton={true}>\n                        <Modal.Title>\n                            Invite a Friend!\n                        </Modal.Title>\n                    </Modal.Header>\n            }\n            <Modal.Body>\n                <p>\n                    {phone() ? \"Have a friend\" : \"Have them\"} open their camera and point at this QR code.\n                    <br/>\n                    They'll join you automatically!\n                </p>\n                <Row>\n                    <Col className=\"flex-grow\"/>\n                    <Col>\n                        <Figure>\n                            <div className={\"qr\"}>\n                                <QRCode size={600} value={gameUrl}/>\n                            </div>\n                            {!phone() && <Figure.Caption>\n                                You can also copy and send them this URL:<br/>\n                                <a href={gameUrl} target=\"_blank\" rel=\"noopener noreferrer\">{gameUrl}</a>\n                            </Figure.Caption>}\n                        </Figure>\n                    </Col>\n                    <Col className=\"flex-grow\"/>\n                </Row>\n                <Row>\n                    {phone() && <Col className=\"flex-grow\"/>}\n                    <Col>\n                        <Form.Group>\n                            {!phone() && <Form.Label>Your Name</Form.Label>}\n                            <Form.Control type=\"input\" placeholder=\"Your Name\"\n                                          value={playerName === DEFAULT_PLAYER_NAME ? undefined : playerName}\n                                          onChange={changeNameThunk}/>\n                        </Form.Group>\n                    </Col>\n                    {phone() && <Col className=\"flex-grow\"/>}\n                </Row>\n            </Modal.Body>\n            {phone()\n                ? <Row>\n                    <Col className=\"flex-grow\"/>\n                    <Col xs={4}>\n                        <Button variant=\"primary\" onClick={play} style={{width: \"100%\"}}>Play</Button>\n                    </Col>\n                    <Col className=\"flex-grow\"/>\n                </Row>\n                : <Modal.Footer>\n                    <Button variant=\"primary\" onClick={play}>Play</Button>\n                </Modal.Footer>\n            }\n        </Modal>;\n\n        function changeNameThunk(event: any) {\n            changePlayerName(event.target.value)\n        }\n    }\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './dialogs.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}